<html lang="en" dir="ltr" class="no-js lazy">

<head>
  <!--<link rel="stylesheet" href="ccs/github.css">-->
  <link rel="stylesheet" href="css/normalize.css">
  <link rel="stylesheet" href="css/main.css">
  <link rel="stylesheet" href="css/image-load.css">
  <link rel="stylesheet" href="css/video-load.css">
  <link rel="stylesheet" href="css/prism.css">
  <!-- <script async src="scripts/menu.js"></script> -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">


  <title></title>
</head>

<body>
<article class="container">
  <h1 id="exploring-color-contrast-on-the-web">Exploring color contrast on the web</h1>
<p>Ironically, it appears that the emergence of an accessibility standard for color contrast has made the web less usable rather than improving the usability and accessibility of text on the web.</p>
<p>A little bit of background.</p>
<p>The W3C chartered the <a href="https://www.w3.org/WAI/">Web Accessibility Initiative</a> as the central place to gather information, research, best practices, and standards (recommendations in W3C talk) for accessibility on the web.</p>
<p>The best-known resource generated by the WAI is the <a href="https://www.w3.org/WAI/standards-guidelines/wcag/">Web Content Accessibility Guidelines (WCAG)</a> recommendation. The current version of WCAG is <a href="https://www.w3.org/TR/WCAG/">2.1</a> with a draft of <a href="https://www.w3.org/TR/WCAG22/">version 2.2</a> expected to become a recommendation soon and an earlier draft of <a href="https://www.w3.org/TR/wcag3/">version 3</a> as an early working draft.</p>
<p>The current version of WCAG provides two guidelines regarding accessibility:</p>
<blockquote>
<p><strong>Success Criterion 1.4.3 Contrast (Minimum)</strong></p>
<p>The visual presentation of text and images of text has a contrast ratio of at least 4.5:1</p>
</blockquote>
<p>and</p>
<blockquote>
<p><strong>Success Criterion 1.4.6 Contrast (Enhanced)</strong></p>
<p>The visual presentation of text and images of text has a contrast ratio of at least 7:1</p>
</blockquote>
<p>Since their introduction WCAG contrast requirements have done an adequate job of guiding what should is good contrast and what isn’t.</p>
<p>But things change. The monitors we use, the devices we view web content on and the research on color perception have all changed since WCAG 2 was first introduced.</p>
<p>In <a href="https://tangledweb.xyz/please-stop-using-grey-text-3d3e71acfca8">Please Stop Using Grey Text</a> Andrew Sommers identifies problems with the way WCAG 2 measures contrast. Some of the biggest issues, to me, are:</p>
<ul>
<li>A one-size fits all approach to contrast doesn’t work
<ul>
<li>Different font styles require different contrast levels (thinner fonts require more contrast)</li>
<li>Different font sizes require different contrast levels</li>
</ul>
</li>
<li>People may need different levels of contrast to make text readable for them</li>
</ul>
<p>The <a href="https://www.w3.org/TR/wcag-3.0/">W3C Accessibility Guidelines (WCAG) 3.0</a> introduces <a href="https://github.com/Myndex/apca-w3">APCA</a>, a new way to measure color contrast that follows modern color and mathematical theories.</p>
<p>APCA addresses the drawbacks of the WCAG 2 contrast method.</p>
<blockquote>
<p>Like color, contrast is not “real”, it is a perception and is more a result of how your brain interprets visual differences. It is not a simple measure of the distance or difference between two colors.</p>
<p>Like all perceptions it is context sensitive, meaning what is around it and its purpose affects how you see it. Contrast is also substantially affected by <strong>“spatial frequency”</strong> which essentially means font size and weight, and is closely related to our brain’s lightness perception (aka luminance contrast). When it comes to color contrast, as in hue/chroma/saturation, the effect is less relevant to readability. High lightness/darkness contrast is required for fluent readability at best speed and comprehension, especially small body text in columns or blocks.</p>
<p>Above a certain amount, <strong>contrast constancy</strong> may come into effect wherein further increases in a mathematical contrast value does not have an effect higher perceived contrast for readability. A high “spatial frequency” means smaller and thinner letters. Smaller, thinner letters or graphics lowers the perceived contrast. As a result, the lightness/darkness difference between text and the background color must be increased to compensate for small thin fonts.</p>
<ul>
<li>Fluent readability refers to <strong>critical contrast</strong> which is that needed for best reading speed and comprehension. Dr. Bailey &amp; Lovie-Kitchin’s studies showed, along with Dr. Legge and other recent studies, contrast must be at least ten times the contrast <strong>sensitivity threshold</strong> (CS) which is the point of “just noticeable differences” (JND). Twenty times is preferred for adequate <strong>contrast reserve</strong> above the critical contrast.</li>
<li>Spot readability means being readable without significant effort, though not necessarily at the best speed or accuracy. In this case the contrast needs to be three times that of the JND.</li>
<li>Various forms of visual impairment include more than acuity, which is the ability to focus the eyes to a sharp clear image. Contrast sensitivity related impairments involving the eyes or brain may have an even greater effect on overall vision.
These factors define the area of “supra-threshold critical contrast for readability.” We refer to this as “readability contrast” for simplicity. A similar supra-threshold exists for acuity in terms of font size, which is separate but in addition to the font sizing as related to spatial-frequency-driven contrast.</li>
</ul>
<p>Source: <a href="https://git.apcacontrast.com/documentation/">Why APCA as a New Contrast Method?</a></p>
</blockquote>
<p>So we have an existing contrast algorithm that has been around for 14+ years with known shortcomings and a new algorithm that will become part of the next version of the specification (WCAG 3) that will not see the light of day for a few more years still.</p>
<p>So how do we leverage this new color contrast method in code?</p>
<h2 id="measuring-contrast-using-color.js">Measuring contrast using color.js</h2>
<p><a href="http://lea.verou.me/">Lea Verou</a> and <a href="https://svgees.us/">Chris Lilley</a>’s <a href="https://colorjs.io/">color.js</a> library provides tools to test contrast between two colors.</p>
<p>Color.js provides eight different contrast methods to test with. The ones I’m most interested in are: <a href="https://colorjs.io/docs/contrast.html#wcag-21">WCAG 2.1</a> and <a href="https://colorjs.io/docs/contrast.html#accessible-perceptual-contrast-algorithm-apca">APCA</a> (as proposed for WCAG 3).</p>
<p>See <a href="https://colorjs.io/docs/contrast.html">Contrast</a> for more information on the methods available to test color contrast with color.js.</p>
<p>We first define the color space that we want to use and the colors we want to test</p>
<pre class="language-js"><code class="language-js"><span class="token comment">// Initialize colors</span>
<span class="token keyword">const</span> text <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Color</span><span class="token punctuation">(</span><span class="token string">"p3"</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0.9</span><span class="token punctuation">,</span> <span class="token number">0.8</span><span class="token punctuation">,</span> <span class="token number">0.1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> background <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Color</span><span class="token punctuation">(</span><span class="token string">"slategrey"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>Then we test the contrast of the two colors using either its dedicated function name, or the general <a href="https://colorjs.io/docs/contrast.html">contrast()</a> function.</p>
<p>The first set of values use the WCAG 2.1 contrast algorithm.</p>
<pre class="language-js"><code class="language-js"><span class="token comment">// WCAG 2.1 contrast</span>
<span class="token keyword">const</span> contrast2a <span class="token operator">=</span> text<span class="token punctuation">.</span><span class="token function">contrastWCAG21</span><span class="token punctuation">(</span>background<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> contrast1a <span class="token operator">=</span> text<span class="token punctuation">.</span><span class="token function">contrastWCAG21</span><span class="token punctuation">(</span>background<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// These values are equivalent</span>
<span class="token keyword">const</span> contrast1 <span class="token operator">=</span> text<span class="token punctuation">.</span><span class="token function">contrast</span><span class="token punctuation">(</span>background<span class="token punctuation">,</span> <span class="token string">"WCAG21"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> contrast2 <span class="token operator">=</span> background<span class="token punctuation">.</span><span class="token function">contrast</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span> <span class="token string">"WCAG21"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>When testing contrast using the WCAG2.1 produces the same results regardless of the order we test.</p>
<pre class="language-js"><code class="language-js"><span class="token comment">// Text on background</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>contrast1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// -> 2.5052963014717715</span>
<span class="token comment">// Background on text</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>contrast2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// -> 2.5052963014717715</span>
</code></pre>
<p>The next tests use the APCA algorithm. In this swapping the order of the colors tested produces different results.</p>
<pre class="language-js"><code class="language-js"><span class="token comment">// APCA contrast</span>
<span class="token keyword">const</span> contrast2 <span class="token operator">=</span> background<span class="token punctuation">.</span><span class="token function">contrast</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span> <span class="token string">"APCA"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> contrast3 <span class="token operator">=</span> text<span class="token punctuation">.</span><span class="token function">contrast</span><span class="token punctuation">(</span>background<span class="token punctuation">,</span> <span class="token string">"APCA"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Background Against Text</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>contrast2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// -> -41.00861317821858</span>

<span class="token comment">// Text Against Background</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>contrast3<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// -> 38.18208871861666</span>
</code></pre>
<p>So, we have values but what do they mean? Since the values and their meaning change when working with APCA we also need to understand what these values mean.</p>
<p>I found <a href="https://twitter.com/DanHollick/status/1468958644364402702?s=20&amp;t=0Yu30BkowoTyQitX_kowPQ">this Twitter thread</a> from Dan Hollick very helpful in understanding what the APCA values mean.</p>
<p>I will try to unpack some of the content of the thread.</p>
<p>In light mode, the higher the positive value is, the higher the contrast.</p>
<p>It uses a 0 to 100 scale.</p>
<p>Dan provides a set of equivalencies between WCAG 2 and APCA</p>
<table>
<thead>
<tr>
<th style="text-align:center">WCAG 2</th>
<th style="text-align:center">APCA</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1.25: 1</td>
<td style="text-align:center">15</td>
<td>Minimum for non-text elements</td>
</tr>
<tr>
<td style="text-align:center">1.5: 1</td>
<td style="text-align:center">30</td>
<td><strong>Rough Equivalency</strong><br /><br />Absolute min for any text</td>
</tr>
<tr>
<td style="text-align:center">3:1</td>
<td style="text-align:center">45</td>
<td><strong>Rough Equivalency</strong><br /><br />Min for large text (the old 3:1)</td>
</tr>
<tr>
<td style="text-align:center">4.5:1</td>
<td style="text-align:center">60</td>
<td><strong>Rough Equivalency</strong><br /><br />Min for body text (the old 4.5:1)</td>
</tr>
<tr>
<td style="text-align:center">7:1</td>
<td style="text-align:center">75</td>
<td><strong>Rough Equivalency</strong><br /><br />Min for body text (the old 4.5:1)</td>
</tr>
<tr>
<td style="text-align:center">10: 1</td>
<td style="text-align:center">90</td>
<td>Preferred level for body text</td>
</tr>
</tbody>
</table>
<p>But see also the following figures that explain what the specific values mean for readability.</p>
<figure>
  <img src='https://res.cloudinary.com/dfh6ihzvj/images/v1670616329/publishing-project.rivendellweb.net/apca-contrast-01/apca-contrast-01.png?_i=AA' width='800'/>
    <img src='https://res.cloudinary.com/dfh6ihzvj/images/v1670616332/publishing-project.rivendellweb.net/apca-contrast-02/apca-contrast-02.png?_i=AA' width='800'/>
  <figcaption>APCA contrast values and explanation. Original from <a href="https://twitter.com/DanHollick/status/1468958658683805703?s=20&t=GMyDkCKNvOjTbEbrr6eGvA"> Dan Hollick</a></figcaption>
</figure>
<p>While WCAG 3 won’t become a recommendation for a while, we can use APCA in our work today.</p>

</article>
<!--
</div> -->
<script src="scripts/lazy-load.js"></script>
<script src="scripts/vendor/clipboard.min.js"></script>
<script src="scripts/vendor/prism.js"></script>
<script src="scripts/vendor/fontfaceobserver.js"></script>
<script src="scripts/load-fonts.js"></script>
<script src="scripts/lazy-load-video.js"></script>
</body>
</html>