<html lang="en" dir="ltr" class="no-js lazy">

<head>
  <!--<link rel="stylesheet" href="ccs/github.css">-->
  <link rel="stylesheet" href="css/normalize.css">
  <link rel="stylesheet" href="css/main.css">
  <link rel="stylesheet" href="css/image-load.css">
  <link rel="stylesheet" href="css/video-load.css">
  <link rel="stylesheet" href="css/prism.css">
  <!-- <script async src="scripts/menu.js"></script> -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">


  <title></title>
</head>

<body>
<article class="container">
  <h1 id="creating-a-standard-css-tolkit-for-wordpress">Creating a standard CSS tolkit for WordPress</h1>
<p><a href="https://mrwweb.com/standardized-design-tokens-css-wordpress-future/">Standardized Design Tokens and CSS for a consistent, customizable, and interoperable WordPress future</a> and <a href="https://wptavern.com/the-case-for-a-shared-css-toolkit-in-wordpress">The Case for a Shared CSS Toolkit in WordPress</a> discuss the need for a standard design toolkit for WordPress.</p>
<p>These needs were articulated in Github Issue 38998: <a href="https://github.com/WordPress/gutenberg/issues/38998">Proposal: Standardized block markup, theme.json design tokens, and CSS classes to improve interoperability</a> outlines the need for standardized design tokens for WordPress.</p>
<p>From my perspective, people who really want deep customizations are likely to use an external design system and an associated set of design tokens.</p>
<p><a href="https://publishing-project.rivendellweb.net/using-design-tokens-in-css/">Using design tokens in CSS</a> discusses Style Dictionary as a way to generate design tokens for multiple platforms.</p>
<p>This post will expand on Style Dictionary and provide a custom format to create a <code>theme.json</code> file.</p>
<p>The idea behind doing this is to keep the design tokens as the source of truth for our projects, regardless of where we use them.</p>
<p>Some caveats before we look at the code:</p>
<ul>
<li>This theme.json file will not contain any block-specific customizations. If you want them that’s up to you</li>
<li>The design tokens include a palette of colors taken from <a href="http://dudleystorey.github.io/thenewdefaults/">The New Defaults</a> along with some <a href="https://rivendellweb-patterns.netlify.app/components/detail/lch-colors--funky.html">funky colors</a> derived from Mopar cars from the '60s and '70s</li>
<li>Where possible we will use <a href="https://rivendellweb-patterns.netlify.app/components/detail/lch-colors--funky.html">LCH colors</a> and a set of <a href="https://rivendellweb-patterns.netlify.app/components/preview/lch-colors--funky.html">funky colors</a> derived from Mopar colors from the 60s and 70s
<ul>
<li>This color space is fairly new so we’ll have to provide conversion tools for browsers that don’t currently support the color space</li>
</ul>
</li>
<li>The code in this post, along with the code in the previous post will produce the following outputs:
<ul>
<li>A set of CSS variables attached to the <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/:root">:root</a> element</li>
<li>A set of SCSS variables built as a partial</li>
<li>A Javascript object that we can use for further processing in other tools</li>
<li>a <code>theme.json</code> file that we can drop in to a WordPress block theme</li>
</ul>
</li>
</ul>
<p>We can add additional formats, both built-in and custom to create the tokens for the platforms we want.</p>
<h2 id="first-look-at-the-code">First Look at the code</h2>
<p>I broke the custom code into three parts:</p>
<ol>
<li>Node modules’ import</li>
<li>Handlebars template compilation</li>
<li>Generating theme.json populated with design tokens</li>
</ol>
<h3 id="node-module-imports">Node Module Imports</h3>
<p>Like any other application, we need to import and, where necessary, initialize the packages we’ll use in the application</p>
<ul>
<li>First we require Syle Dictionary and extend an existing configuration file</li>
<li>The <code>fs</code> module is necessary to read the template file for handlebars to process</li>
</ul>
<pre class="language-js"><code class="language-js"><span class="token keyword">const</span> StyleDictionary <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'style-dictionary'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span>__dirname <span class="token operator">+</span> <span class="token string">'/config.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> handlebars <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'handlebars'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h3 id="handlebars-template-compilation">Handlebars template compilation</h3>
<p>We first compile the Handlebars template before we can use it in the next step. I chose Handlebars because that’s what I’m familiar with and because it gives me flexibility moving forward.</p>
<pre class="language-js"><code class="language-js"><span class="token keyword">const</span> templateCustomWordpress <span class="token operator">=</span> handlebars<span class="token punctuation">.</span><span class="token function">compile</span><span class="token punctuation">(</span>
  fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>__dirname <span class="token operator">+</span> 
  <span class="token string">'/templates/wordpress-template.hbs'</span><span class="token punctuation">,</span>
  <span class="token string">'utf8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h3 id="generating-theme.json">Generating <code>theme.json</code></h3>
<p>The final step is to register the new format for Style Dictionary.</p>
<p><code>transformGroup</code> tells Style Dictionary what transformation to apply to the file.</p>
<p><code>formatter</code> defines what the format will look like. We include the template we defined in the last step.</p>
<pre class="language-js"><code class="language-js"><span class="token comment">// 3</span>
StyleDictionary<span class="token punctuation">.</span><span class="token function">registerFormat</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">transformGroup</span><span class="token operator">:</span> <span class="token string">"web"</span><span class="token punctuation">,</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'wordpress'</span><span class="token punctuation">,</span>
  <span class="token function-variable function">formatter</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">dictionary<span class="token punctuation">,</span> platform</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">templateCustomWordpress</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">allProperties</span><span class="token operator">:</span> dictionary<span class="token punctuation">.</span>allProperties<span class="token punctuation">,</span>
      <span class="token literal-property property">properties</span><span class="token operator">:</span> dictionary<span class="token punctuation">.</span>properties<span class="token punctuation">,</span>
      <span class="token literal-property property">options</span><span class="token operator">:</span> platform
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>We then build all platforms we’ve configured both here and in the main configuration file.</p>
<p>This means that instead of building with <code>style-dictionary build</code> we run <code>node build.js</code> to make out tokens.</p>
<pre class="language-js"><code class="language-js">StyleDictionary<span class="token punctuation">.</span><span class="token function">buildAllPlatforms</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h2 id="building-out-design-tokens">building out design tokens</h2>
<p>The first thing that we need to do is figure out how we want to structure our tokens and whether the existingg structure works well enough to adopt it for our uses.</p>
<figure>
  <img src='https://res.cloudinary.com/dfh6ihzvj/images/v1676001635/publishing-project.rivendellweb.net/style-dictionary-model/style-dictionary-model.webp?_i=AA' width='800'>
  <figcaption>Style dictionary implicit hierarchy</figcaption>
</figure>
<p>One options is to follow the examples provided when you initialize the library. The color block looks like the block below:</p>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"color"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"base"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"blue"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"50"</span>  <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"#E3F2FD"</span><span class="token punctuation">,</span> <span class="token property">"attributes"</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token property">"font"</span><span class="token operator">:</span> <span class="token string">"base"</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"100"</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"#BBDEFB"</span><span class="token punctuation">,</span> <span class="token property">"attributes"</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token property">"font"</span><span class="token operator">:</span> <span class="token string">"base"</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"200"</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"#90CAF9"</span><span class="token punctuation">,</span> <span class="token property">"attributes"</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token property">"font"</span><span class="token operator">:</span> <span class="token string">"base"</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"300"</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"#64B5F6"</span><span class="token punctuation">,</span> <span class="token property">"attributes"</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token property">"font"</span><span class="token operator">:</span> <span class="token string">"base"</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"400"</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"#42A5F5"</span><span class="token punctuation">,</span> <span class="token property">"attributes"</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token property">"font"</span><span class="token operator">:</span> <span class="token string">"inverse"</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"500"</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"#2196F3"</span><span class="token punctuation">,</span> <span class="token property">"attributes"</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token property">"font"</span><span class="token operator">:</span> <span class="token string">"inverse"</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"600"</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"#1E88E5"</span><span class="token punctuation">,</span> <span class="token property">"attributes"</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token property">"font"</span><span class="token operator">:</span> <span class="token string">"inverse"</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"700"</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"#1976D2"</span><span class="token punctuation">,</span> <span class="token property">"attributes"</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token property">"font"</span><span class="token operator">:</span> <span class="token string">"inverse"</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"800"</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"#1565C0"</span><span class="token punctuation">,</span> <span class="token property">"attributes"</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token property">"font"</span><span class="token operator">:</span> <span class="token string">"inverse"</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"900"</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"#0D47A1"</span><span class="token punctuation">,</span> <span class="token property">"attributes"</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token property">"font"</span><span class="token operator">:</span> <span class="token string">"inverse"</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"A100"</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"#82B1FF"</span><span class="token punctuation">,</span> <span class="token property">"attributes"</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token property">"font"</span><span class="token operator">:</span> <span class="token string">"base"</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"A200"</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"#448AFF"</span><span class="token punctuation">,</span> <span class="token property">"attributes"</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token property">"font"</span><span class="token operator">:</span> <span class="token string">"inverse"</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"A400"</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"#2979FF"</span><span class="token punctuation">,</span> <span class="token property">"attributes"</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token property">"font"</span><span class="token operator">:</span> <span class="token string">"inverse"</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"A700"</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"#2962FF"</span><span class="token punctuation">,</span> <span class="token property">"attributes"</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token property">"font"</span><span class="token operator">:</span> <span class="token string">"inverse"</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>it’s modeled after Material Design’s color palettes with values starting at 50 and then jumping to 100 and going to 900. It also adds accent colors for some values in the scale (100, 200, 400, and 700).</p>
<p>Another option is to create your own structure for the tokens.</p>
<p>This palette uses a section from <a href="http://dudleystorey.github.io/thenewdefaults/">The New Defaults</a> and uses a different scheme since the colors are not purpose-based.</p>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"hex_colors"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"whites"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"white"</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"#fffeff"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">"alabaster"</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"#fefaf0"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">"snow"</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"#f4fefd"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">"ivory"</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"#fef7e5"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">"cream"</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"#fffbda"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">"eggshell"</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"#fef9e3"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">"cotton"</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"#fbfcf7"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">"chiffon"</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"#fafaf1"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">"salt"</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"#f8efec"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">"lace"</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"#faf3ea"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">"coconut"</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"#fff1e6"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">"linen"</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"#f2ebd3"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">"bone"</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"#e7dfcc"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">"porcelain"</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"#fffffc"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">"parchment"</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"#fcf6df"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">"rice"</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"#fbf6ef"</span> <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>This would be more helpful when providing a set of colors rather than a predefined palette. It puts the onus on you as the designer to pick what colors to use but it gives you a richer plaette of colors to experiment with.</p>
<p>So far, we’ve experimented with colors but we can do the same thing with basic layout elements and even with <code>@font-face</code> declarations.</p>
<p>The following block describes the properties of the Recursive font that I use in most of my designs.</p>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"font"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"family"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"name"</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"Recursive Sans"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">"stack"</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"Recursive, sans-serif"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">"format"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"woff2"</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"./assets/fonts/recursive.woff2"</span> <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">"weight"</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"300 100"</span> <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> 
    <span class="token property">"instances"</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>Recursive is a variable font so it presents additional challenges:</p>
<p>It has multiple possible combinations of fonts using both custom and fixed axes to represent sans-serif, serif and mono-spaced variants.</p>
<p>Because browsers don’t support custom axes via CSS, we need to go lower and use <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/font-feature-settings">font-feature-settings</a> to define them. This will also address inheritance of font-feature-settings as described in <a href="https://pixelambacht.nl/2022/boiled-down-fixing-variable-font-inheritance/">Boiled down: fixing the variable font inheritance problem</a></p>
<h2 id="putting-the-tokens-together">Putting the tokens together</h2>
<p>Regardless of the schema we choose, we can then take these colors and usem to build our primary, secondary and additional models that we need.</p>
<p>We can do this using references. If using the New Default Palettes, we can do something like this:</p>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"primary"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"color"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"text"</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"{hex_colors.blacks.charcoal}"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">"background"</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"{hex_colors.whites.white}"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">"link"</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"{hex_colors.reds.cherry}"</span> <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id="adding-metadata-to-the-tokens">Adding metadata to the tokens</h2>
<p>Not all formats need the same amount of data. For example, when creating a <code>theme.json</code> file for WordPress, each color needs a <code>name</code> and a <code>slug</code> in addition to the “value” in each field. Fortunately we can add them as attributes only where they are necessary. I’ve chosen to add the <code>name</code> and <code>slug</code> to both the LCH and HEX palettes as a way to future proof my code since I would rather not wait until WordPress CSS engine gainst support for LCH colors.</p>
<p>So now the colors look like this:</p>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"hex_colors"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"whites"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"white"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"#fffeff"</span><span class="token punctuation">,</span>
        <span class="token property">"attributes"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"White"</span><span class="token punctuation">,</span>
          <span class="token property">"slug"</span><span class="token operator">:</span> <span class="token string">"white"</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">"alabaster"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"#fefaf0"</span><span class="token punctuation">,</span>
        <span class="token property">"attributes"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Alabaster"</span><span class="token punctuation">,</span>
          <span class="token property">"slug"</span><span class="token operator">:</span> <span class="token string">"alabaster"</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">"snow"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"#f4fefd"</span><span class="token punctuation">,</span>
        <span class="token property">"attributes"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Snow"</span><span class="token punctuation">,</span>
          <span class="token property">"slug"</span><span class="token operator">:</span> <span class="token string">"snow"</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">"ivory"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"#fef7e5"</span><span class="token punctuation">,</span>
        <span class="token property">"attributes"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Ivory"</span><span class="token punctuation">,</span>
          <span class="token property">"slug"</span><span class="token operator">:</span> <span class="token string">"ivory"</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">"cream"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"#fffbda"</span><span class="token punctuation">,</span>
        <span class="token property">"attributes"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Cream"</span><span class="token punctuation">,</span>
          <span class="token property">"slug"</span><span class="token operator">:</span> <span class="token string">"cream"</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">"eggshell"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"#fef9e3"</span><span class="token punctuation">,</span>
        <span class="token property">"attributes"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Eggshell"</span><span class="token punctuation">,</span>
          <span class="token property">"slug"</span><span class="token operator">:</span> <span class="token string">"eggshell"</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">"cotton"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"#fbfcf7"</span><span class="token punctuation">,</span>
        <span class="token property">"attributes"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Cotton"</span><span class="token punctuation">,</span>
          <span class="token property">"slug"</span><span class="token operator">:</span> <span class="token string">"cotton"</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">"chiffon"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"#fafaf1"</span><span class="token punctuation">,</span>
        <span class="token property">"attributes"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Chiffon"</span><span class="token punctuation">,</span>
          <span class="token property">"slug"</span><span class="token operator">:</span> <span class="token string">"chiffon"</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">"salt"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"#f8efec"</span><span class="token punctuation">,</span>
        <span class="token property">"attributes"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Salt"</span><span class="token punctuation">,</span>
          <span class="token property">"slug"</span><span class="token operator">:</span> <span class="token string">"salt"</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">"lace"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"#faf3ea"</span><span class="token punctuation">,</span>
        <span class="token property">"attributes"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Lace"</span><span class="token punctuation">,</span>
          <span class="token property">"slug"</span><span class="token operator">:</span> <span class="token string">"lace"</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">"coconut"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"#fff1e6"</span><span class="token punctuation">,</span>
        <span class="token property">"attributes"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Coconut"</span><span class="token punctuation">,</span>
          <span class="token property">"slug"</span><span class="token operator">:</span> <span class="token string">"coconut"</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">"linen"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"#f2ebd3"</span><span class="token punctuation">,</span>
        <span class="token property">"attributes"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Linen"</span><span class="token punctuation">,</span>
          <span class="token property">"slug"</span><span class="token operator">:</span> <span class="token string">"linen"</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">"bone"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"#e7dfcc"</span><span class="token punctuation">,</span>
        <span class="token property">"attributes"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Bone"</span><span class="token punctuation">,</span>
          <span class="token property">"slug"</span><span class="token operator">:</span> <span class="token string">"bone"</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">"porcelain"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"#fffffc"</span><span class="token punctuation">,</span>
        <span class="token property">"attributes"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Porcelain"</span><span class="token punctuation">,</span>
          <span class="token property">"slug"</span><span class="token operator">:</span> <span class="token string">"porcelain"</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">"parchment"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"#fcf6df"</span><span class="token punctuation">,</span>
        <span class="token property">"attributes"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Parchment"</span><span class="token punctuation">,</span>
          <span class="token property">"slug"</span><span class="token operator">:</span> <span class="token string">"parchment"</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">"rice"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"#fbf6ef"</span><span class="token punctuation">,</span>
        <span class="token property">"attributes"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Rice"</span><span class="token punctuation">,</span>
          <span class="token property">"slug"</span><span class="token operator">:</span> <span class="token string">"rice"</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>We can also create colors derived from our base palette.</p>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"primary"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"color"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"text"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"{ hex_colors.blacks.charcoal }"</span><span class="token punctuation">,</span>
        <span class="token property">"attributes"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Text"</span><span class="token punctuation">,</span>
          <span class="token property">"slug"</span><span class="token operator">:</span> <span class="token string">"text"</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">"background"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"{ hex_colors.whites.white }"</span><span class="token punctuation">,</span>
        <span class="token property">"attributes"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Background"</span><span class="token punctuation">,</span>
          <span class="token property">"slug"</span><span class="token operator">:</span> <span class="token string">"background"</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">"link"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"{ hex_colors.reds.cherry }"</span><span class="token punctuation">,</span>
        <span class="token property">"attributes"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"link"</span><span class="token punctuation">,</span>
          <span class="token property">"slug"</span><span class="token operator">:</span> <span class="token string">"link"</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id="putting-it-all-together">Putting it all together</h2>
<p>The handlebars template is fairly simple.</p>
<p>It’s text file using the <code>hbs</code> extension that contains the text that we want to work with and interpolated content.</p>
<p>For this example, I’ve taken the colors portion of the <code>theme.json</code> template and prefiled it with values.</p>
<pre class="language-handlebars"><code class="language-handlebars">{
  "$schema": "https://schemas.wp.org/trunk/theme.json",
  "version": 2,
  "settings": {
    "appearanceTools": true,
    "color": {
      "palette": [
        {
          "color": "#ffffff",
          "name": "Base",
          "slug": "base"
        },
        {
          "color": "#000000",
          "name": "Contrast",
          "slug": "contrast"
        },
        {
          "color": "#9DFF20",
          "name": "Primary",
          "slug": "primary"
        },
        {
          "color": "#345C00",
          "name": "Secondary",
          "slug": "secondary"
        },
        {
          "color": "#F6F6F6",
          "name": "Tertiary",
          "slug": "tertiary"
        }
      ]
    }
  ]
}
</code></pre>
<p>For the <code>theme.json</code> template, I’ve chosen to only use the base elements, not change any custom block styles.</p>
<p>The goal now is to populate the template with data.</p>
<p>Wherever we want to insert data we use moustache syntax:</p>

</article>
<!--
</div> -->
<script src="scripts/lazy-load.js"></script>
<script src="scripts/vendor/clipboard.min.js"></script>
<script src="scripts/vendor/prism.js"></script>
<script src="scripts/vendor/fontfaceobserver.js"></script>
<script src="scripts/load-fonts.js"></script>
<script src="scripts/lazy-load-video.js"></script>
</body>
</html>