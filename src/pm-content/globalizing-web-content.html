<html lang="en">

<head>
  <!-- <link rel="stylesheet" href="../paged-media/highlight/styles/solarized-light.css"> -->
  <link rel="stylesheet" href="../paged-media/prism/prism.css">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,minimum-scale=1,maximum-scale=1">
  <title></title>
</head>

<body data-type="book">

  <p><a id="markdown-globalizing-web-content" name="globalizing-web-content"></a></p>
<h1>Globalizing Web Content</h1>
<!-- TOC -->
<ul>
<li><a href="#globalizing-web-content">Globalizing Web Content</a>
<ul>
<li><a href="#difference-between-l10n-and-i18n">Difference between l10n and i18n</a></li>
<li><a href="#what-type-of-internationalization-can-we-automate">What type of internationalization can we automate?</a></li>
<li><a href="#quick-and-dirty-js-template-string-literals">Quick and Dirty: JS Template String Literals</a></li>
<li><a href="#messages-gender--and-plural-capable-messages">Messages: Gender- and plural-capable messages</a></li>
<li><a href="#the-big-guns-globalize">The big guns: Globalize</a>
<ul>
<li><a href="#npm">NPM</a></li>
<li><a href="#adding-webpack-to-the-mix">Adding Webpack to the mix</a></li>
</ul>
</li>
<li><a href="#caching-localization-assets-with-service-workers">Caching localization assets with service workers</a></li>
<li><a href="#handling-content-for-multiple-languages">Handling content for multiple languages</a></li>
<li><a href="#links-and-resources">Links and Resources</a></li>
</ul>
</li>
</ul>
<!-- /TOC -->
<p>I’ve always been interested in internationalization (i18n) and localization (l10n) and how they relate to the web. My interest got picked again when I started wondering how much extra work would it be to keep a site or app in multiple languages and how much time and how many additional resources I’d need to get it done.</p>
<p>This goes beyond translating the content; tools like Google Translate make that part easier than it used to be but also the changes and modifications that we need to do to our code to acomodate for the different languages and cultures we want to deploy our application in.</p>
<p><a id="markdown-difference-between-l10n-and-i18n" name="difference-between-l10n-and-i18n"></a></p>
<h2>Difference between l10n and i18n</h2>
<p>Before we can jump in and talk about localizing web content and the challenges involved we need to understand the difference between localization (l10n for the 10 letters between l and n in the word localization in English) and Intenationalization (i18n for the 18 letters between i an n in the word internationalization in English)</p>
<p><strong>Localization</strong></p>
<p>Localization refers to the adaptation of a product, application or document content to meet the language, cultural and other requirements of a specific target market (a locale).</p>
<p>Often thought of as a synonym for translation of the user interface and documentation, localization is often a much more complex issue. It can entail customization related to:</p>
<ul>
<li>Numeric, date and time formats</li>
<li>Use of currency</li>
<li>Keyboard usage</li>
<li>Collation and sorting of content</li>
<li>Symbols, icons and colors</li>
<li>Text and graphics containing references to objects, actions or ideas which, in a given culture, may be subject to misinterpretation or viewed as insensitive</li>
<li>Varying legal requirements</li>
</ul>
<p>and potentially other aspects of our applications.</p>
<p>Localization may even require a comprehensive rethinking of logic, visual design, or presentation if the way of doing business (eg., accounting) or the accepted paradigm for learning (eg., focus on individual vs. group) in a given locale differs substantially from the originating culture.</p>
<p><strong>Internationalization</strong></p>
<p>Definitions of internationalization consty. This is a high-level working definition for use with W3C Internationalization Activity material. Some people use other terms, such as globalization to refer to the same concept.</p>
<p>Internationalization is the design and development of a product, application or document content that enables easy localization for target audiences that consty in culture, region, or language.</p>
<p>Internationalization typically entails:</p>
<ol>
<li>Designing and developing in a way that removes barriers to localization or international deployment. This includes activities like enabling the use of Unicode, or ensuring the proper handling of legacy character encodings (where appropriate), taking care over the concatenation of strings, decoupling the backend code from the UI text, etc</li>
<li>Providing support for features that may not be used until localization occurs. For example, adding markup or CSS code to support bidirectional text, or for identifying language, or adding to CSS support for vertical text or other non-Latin typographic features.</li>
<li>Enabling code to support local, regional, language, or culturally related preferences. Typically this involves incorporating predefined localization data and features derived from existing libraries or user preferences. Examples include date and time formats, local calendars, number formats and numeral systems, sorting and presentation of lists, handling of personal names and forms of address, etc.</li>
<li>Separating localizable elements from source code or content, such that localized alternatives can be loaded or selected based on the user’s international preferences as needed.</li>
<li>Notice that these items do not necessarily include the localization of the content, application, or product into another language; they are design and development practices which allow such a migration to take place easily in the future but which may have significant utility even if no localization ever takes place.</li>
</ol>
<p><a id="markdown-what-type-of-internationalization-can-we-automate" name="what-type-of-internationalization-can-we-automate"></a></p>
<h2>What type of internationalization can we automate?</h2>
<aside class="message info">
  <p>The following sections on automating i18n work with templating (mustache and similar) or other ways to programmatically generate content.</p>
</aside>
<p>For the most part we automate UI internationalization and localize only those aspects of the user interface that will change when we change the language we use.  Note that this will work in applications and sites that generate HTML from Javascript.</p>
<p>Depending on the tools we use we may be further limited in what we can and cannot localize programmatically, particularly content other than UI.</p>
<p><a id="markdown-quick-and-dirty-js-template-string-literals" name="quick-and-dirty-js-template-string-literals"></a></p>
<h2>Quick and Dirty: JS Template String Literals</h2>
<aside class="message info">
  <p>This is a quick recap of an <a href="http://publishing-project.rivendellweb.net/js-template-literals/">earlier post</a> that described Javascript Template String Literals and one way to use them to provide content translation.</p>
</aside>
<p>Andrea Giamarchi wrote an article: &quot;<a href="https://codeburst.io/easy-i18n-in-10-lines-of-javascript-poc-eb9e5444d71e">Easy i18n in 10 lines of JavaScript (PoC)</a>&quot; that provides an idea of how to do translation using template literals. This code has been further developed in a <a href="https://github.com/WebReflection/i18n-utils">Github Repo</a>.</p>
<p>See the article in <a href="http://publishing-project.rivendellweb.net/js-template-literals/">my blog</a> and Andrea’s post for more information.</p>
<p><a id="markdown-messages-gender--and-plural-capable-messages" name="messages-gender--and-plural-capable-messages"></a></p>
<h2>Messages: Gender- and plural-capable messages</h2>
<p>The next step is to use <a href="https://messageformat.github.io/">Messages</a>. We use the library to separate your code from your text formatting, while enabling much more humane expressions. This library will eliminate the following from your UI:</p>
<ul>
<li>There are 1 results.</li>
<li>There are 1 result(s).</li>
<li>Number of results: 5.</li>
</ul>
<p>The installation process is just like any other application:</p>
<pre class="command-line language-bash" data-user="elrond25" data-host="rivendell"><code>npm --save install messageformat</code></pre>
<p>Once it’s installed we require it like any other in a Node application.</p>
<pre><code class="language-javascript">const MessageFormat = require('messageformat');
</code></pre>
<p>We then build the message we want to display to our users. In this case we build a messsage with three rules:</p>
<ul>
<li>A gender (GENDER) rule with values for male, female and other</li>
<li>A Resource (RES) rule with values for no results, (exactly) 1 result and more than one result</li>
<li>A Catergory (rule) with ordinal values for one, two, third and other categories</li>
</ul>
<pre><code class="language-javascript">const msg =
  '{GENDER, select, male{He} female{She} other{They} }' +
  ' found ' +
  '{RES, plural, =0{no results} one{1 result} other{# results} }' +
  ' in the ' +
  '{CAT, selectordinal, one{#st} two{#nd} few{#rd} other{#th} }' +
  ' category.';
</code></pre>
<p>The last step is to compile the rules and use it as needed. The compilation makes it possible to use the different combinations of the values defined in our message variables.</p>
<p>Using the compiled message we build using <code>mfunc</code> and the values for the categories that we created when we defined the message.  The examples below show how the different combinations of messages.</p>
<pre><code class="language-javascript">// Compiles the messages and formats.
const mfunc = new MessageFormat('en').compile(msg);

mfunc({ GENDER: 'male', RES: 1, CAT: 2 })
// 'He found 1 result in the 2nd category.'

mfunc({ GENDER: 'female', RES: 1, CAT: 2 })
// 'She found 1 result in the 2nd category.'

mfunc({ GENDER: 'male', RES: 2, CAT: 1 })
// 'He found 2 results in the 1st category.'

mfunc({ RES: 2, CAT: 2 })
// 'They found 2 results in the 2nd category.'
</code></pre>
<p>For more information on how to use the formating capabilities of Messageformat, check the <a href="https://messageformat.github.io/guide/">Format Guide</a> particularly the sections where it gives instructions for what values to use in what situation.</p>
<p><a id="markdown-the-big-guns-globalize" name="the-big-guns-globalize"></a></p>
<h2>The big guns: Globalize</h2>
<p>GLobalize is the heavy gun in the i18n world. It’ll automate most of the i18n work and integrate ICU and CLDR into one application.</p>
<div class="youtube-player" data-id="T8xcBcCn9fs"></div>
<!-- <div class="video">
  <iframe width="560" height="315" src="https://www.youtube.com/embed/T8xcBcCn9fs?rel=0" frameborder="0" allowfullscreen></iframe>
</div> -->
<div class="youtube-player" data-id="h3p8cGOZ8CU"></div>
<!-- <div class="video">
  <iframe width="560" height="315" src="https://www.youtube.com/embed/h3p8cGOZ8CU?rel=0" frameborder="0" allowfullscreen></iframe>
</div> -->
<pre class="command-line language-bash" data-user="elrond25" data-host="rivendell"><code>npm install --save globalize </code></pre>
<p>or build from the <a href="https://github.com/globalizejs/">Github development branch</a></p>
<pre class="command-line language-bash" data-user="elrond25" data-host="rivendell"><code>git clone https://github.com/globalizejs/globalize.git
bower install && npm install
grunt</code></pre>
<aside class="message warning">
  <p>If you choose to build globalize from source please make sure you run Bower install command before NPM. It took me a while to figure out that this was causing installation errors when building from GIT source.</p>
  <p>Depending on your needs it may be better to start with a pre-built distribution of the libraries.</p>
</aside>
<p>Globalize makes heavy use of the CLDR data set and, in the examples below, the installation process through NPM will take care of installing the CLDR data. To illustrate how this works we’ll look at two examples from the Globalize repository, one running NPM to create text-based responses and one using NPM and WebPack to generate bundles for each of our target languages.</p>
<p><a id="markdown-npm" name="npm"></a></p>
<h3>NPM</h3>
<p>The first example we’ll look at it is a Node based app that will output all the results to the console.  The <code>package.json</code> file, as with any Node-based project, tells NPM what packages and versions to install.</p>
<pre><code class="language-javascript">{
  &quot;name&quot;: &quot;globalize-hello-world-node-npm&quot;,
  &quot;private&quot;: true,
  &quot;dependencies&quot;: {
    &quot;cldr-data&quot;: &quot;latest&quot;,
    &quot;globalize&quot;: &quot;^1.3.0&quot;,
    &quot;iana-tz-data&quot;: &quot;&gt;=2017.0.0&quot;
  },
  &quot;cldr-data-urls-filter&quot;: &quot;(core|dates|numbers|units)&quot;
}
</code></pre>
<p><code>main.js</code> has all the code that will load and run Globalize tools. I’ ve commented the code to illustrate what it does.</p>
<pre><code class="language-javascript">const Globalize = require( &quot;globalize&quot; );

let like;

// Before we can use Globalize, we need to feed it on
// the appropriate I18n content (Unicode CLDR).
Globalize.load(
    require( &quot;cldr-data/main/en/ca-gregorian&quot; ),
    require( &quot;cldr-data/main/en/currencies&quot; ),
    require( &quot;cldr-data/main/en/dateFields&quot; ),
    require( &quot;cldr-data/main/en/numbers&quot; ),
    require( &quot;cldr-data/main/en/timeZoneNames&quot; ),
    require( &quot;cldr-data/main/en/units&quot; ),
    require( &quot;cldr-data/supplemental/currencyData&quot; ),
    require( &quot;cldr-data/supplemental/likelySubtags&quot; ),
    require( &quot;cldr-data/supplemental/metaZones&quot; ),
    require( &quot;cldr-data/supplemental/plurals&quot; ),
    require( &quot;cldr-data/supplemental/timeData&quot; ),
    require( &quot;cldr-data/supplemental/weekData&quot; )
);
// Load messages for our default language
Globalize.loadMessages( require( &quot;./messages/en&quot; ) );
// Load time zone data
Globalize.loadTimeZone( require( &quot;iana-tz-data&quot; ) );

// Set &quot;en&quot; as our default locale.
Globalize.locale( &quot;en&quot; );

// Use Globalize to format dates.
console.log( Globalize.formatDate( new Date(), { datetime: &quot;medium&quot; } ) );

// Use Globalize to format dates in specific time zones.
console.log( Globalize.formatDate( new Date(), {
    datetime: &quot;full&quot;,
    timeZone: &quot;America/Sao_Paulo&quot;
}));

// Use Globalize to format dates to parts.
console.log( Globalize.formatDateToParts( new Date(), { datetime: &quot;medium&quot; } ) );

// Use Globalize to format numbers.
console.log( Globalize.formatNumber( 12345.6789 ) );

// Use Globalize to format currencies.
console.log( Globalize.formatCurrency( 69900, &quot;USD&quot; ) );

// Use Globalize to get the plural form of a numeric value.
console.log( Globalize.plural( 12345.6789 ) );

// Use Globalize to format a message with plural inflection.
like = Globalize.messageFormatter( &quot;like&quot; );
console.log( like( 0 ) ); // Be the first to like this
console.log( like( 1 ) ); // You liked this
console.log( like( 2 ) ); // You and someone else liked this
console.log( like( 3 ) ); // You and 2 others liked this

// Use Globalize to format relative time.
console.log( Globalize.formatRelativeTime( -35, &quot;second&quot; ) );

// Use Globalize to format unit.
console.log( Globalize.formatUnit( 60, &quot;mile/hour&quot;, { form: &quot;short&quot; } ) );
</code></pre>
<p>Run the program from a terminal by running <code>node main.js</code>.</p>
<p><a id="markdown-adding-webpack-to-the-mix" name="adding-webpack-to-the-mix"></a></p>
<h3>Adding Webpack to the mix</h3>
<p>The second example is more complex and uses Globalize, the CLDR data files, IANA timezone data and Webpack specific tools, including a custom <code>globalize-webpack-plugin</code>.</p>
<p>The first component is the <code>package.json</code> file that will tell NPM what packkes and versions to install and what commands to run. If you’re familiar with Webpack  the commands in the script commands should look familiar.</p>
<pre><code class="language-javascript">{
  &quot;private&quot;: true,
  &quot;devDependencies&quot;: {
    &quot;cldr-data&quot;: &quot;&gt;=25&quot;,
    &quot;globalize&quot;: &quot;^1.3.0&quot;,
    &quot;globalize-webpack-plugin&quot;: &quot;0.4.x&quot;,
    &quot;html-webpack-plugin&quot;: &quot;^1.1.0&quot;,
    &quot;iana-tz-data&quot;: &quot;^2017.1.0&quot;,
    &quot;nopt&quot;: &quot;^3.0.3&quot;,
    &quot;webpack&quot;: &quot;^1.9.0&quot;,
    &quot;webpack-dev-server&quot;: &quot;^1.9.0&quot;
  },
  &quot;scripts&quot;: {
    &quot;start&quot;: &quot;webpack-dev-server --config webpack-config.js \
    --hot --progress --colors --inline&quot;,
    &quot;build&quot;: &quot;webpack --production --config webpack-config.js&quot;
  },
  &quot;cldr-data-urls-filter&quot;: &quot;(core|dates|numbers|units)&quot;
}
</code></pre>
<p><code>webpack-config.js</code> build the Webpack side of the equation. It requires the packages needed, configures Webpack and specifies the bunldes to build:</p>
<ol>
<li><code>vendor</code>, which holds Globalize Runtime modules and other third party libraries</li>
<li><code>i18n precompiled data</code>, which means the minimum yet sufficient set of precompiled i18n data that your application needs (one file for each supported locale)</li>
<li><code>app</code>, which means your application code. Also note that all the production code is already minified using UglifyJS.</li>
</ol>
<p>The configuration uses <strong><a href="https://github.com/jantimon/html-webpack-plugin">html-webpack-plugin</a></strong> to populate links and names for our HTML template file (discussed later) and <strong><a href="https://github.com/rxaviers/globalize-webpack-plugin">globalize-webpack-plugin</a></strong> to handle generating the Globalize bundles.</p>
<p>In a later section we’ll add another plugin to this Webpack configuration. You can also add more to it based on your build system requirements.</p>
<pre><code class="language-javascript">var webpack = require( &quot;webpack&quot; );
var CommonsChunkPlugin = require( &quot;webpack/lib/optimize/CommonsChunkPlugin&quot; );
var HtmlWebpackPlugin = require( &quot;html-webpack-plugin&quot; );
var GlobalizePlugin = require( &quot;globalize-webpack-plugin&quot; );
var nopt = require( &quot;nopt&quot; );

var options = nopt({
  production: Boolean
});

module.exports = {
  entry: options.production ?  {
    main: &quot;./app/index.js&quot;,
    vendor: [
      &quot;globalize&quot;,
      &quot;globalize/dist/globalize-runtime/number&quot;,
      &quot;globalize/dist/globalize-runtime/currency&quot;,
      &quot;globalize/dist/globalize-runtime/date&quot;,
      &quot;globalize/dist/globalize-runtime/message&quot;,
      &quot;globalize/dist/globalize-runtime/plural&quot;,
      &quot;globalize/dist/globalize-runtime/relative-time&quot;,
      &quot;globalize/dist/globalize-runtime/unit&quot;
    ]
  } : &quot;./app/index.js&quot;,
  debug: !options.production,
  output: {
    path: options.production ? &quot;./dist&quot; : &quot;./tmp&quot;,
    publicPath: options.production ? &quot;&quot; : &quot;http://localhost:8080/&quot;,
    filename: options.production ? &quot;app.[hash].js&quot; : &quot;app.js&quot;
  },
  resolve: {
    extensions: [ &quot;&quot;, &quot;.js&quot; ]
  },
  plugins: [
    new HtmlWebpackPlugin({
      production: options.production,
      template: &quot;./index-template.html&quot;
    }),
    new GlobalizePlugin({
      production: options.production,
      developmentLocale: &quot;en&quot;,
      supportedLocales: [ &quot;ar&quot;, &quot;de&quot;, &quot;en&quot;, &quot;es&quot;, &quot;pt&quot;, &quot;ru&quot;, &quot;zh&quot; ],
      messages: &quot;messages/[locale].json&quot;,
      output: &quot;i18n/[locale].[hash].js&quot;
    })
  ].concat( options.production ? [
    new webpack.optimize.DedupePlugin(),
    new CommonsChunkPlugin( &quot;vendor&quot;, &quot;vendor.[hash].js&quot; ),
    new webpack.optimize.UglifyJsPlugin({
      compress: {
        warnings: false
      }
    })
  ] : [] )
};
</code></pre>
<p><code>index.js</code> runs the globalization tasks that we want the user to see. THis is a contrived example meant to exercise the llibrary and show what it can do. That said it gives you an idea of the power of GLobalize and what we can use it for.</p>
<p>This looks like a prime use of ES6 String Literals to make them easier to read and reason through. A lot of it will depend on your target browsers and what your team is comfortable with.</p>
<p>These tasks work on the localization tasks for our application. We’re capable of changing all the localized elements in the page by only changing the locale we are working with. We can also change the language programmatically based on user interaction.</p>
<p>The first two examples work with number formatting, one for numbers (where the locale indicates how to format decimals and number separators) and one for currency.</p>
<pre><code class="language-javascript">var Globalize = require( &quot;globalize&quot; );
var startTime = new Date();

// Standalone table.
var numberFormatter = Globalize.numberFormatter({ maximumFractionDigits: 2 });
document.getElementById( &quot;number&quot; ).textContent = numberFormatter( 12345.6789 );

var currencyFormatter = Globalize.currencyFormatter( &quot;USD&quot; );
document.getElementById( &quot;currency&quot; ).textContent = currencyFormatter( 69900 );
</code></pre>
<p>Dates are more complicated. The first example formats a date using the default formatting rules for the locale we are using.</p>
<p>The second data example uses an array to indicate the format for the date (<code>datetime</code>) and a full IANA time zone like <code>America/Sao_Paulo</code> or <code>America/Los_Angeles</code>) to indicate the offset to use and the name of the Time Zone that corresponds to the location. It then uses the array we created to display the date.</p>
<pre><code class="language-javascript">var dateFormatter = Globalize.dateFormatter({ datetime: &quot;medium&quot; });
document.getElementById( &quot;date&quot; ).textContent = dateFormatter( new Date() );

var dateWithTimeZoneFormatter = Globalize.dateFormatter({
    datetime: &quot;full&quot;,
    timeZone: &quot;America/Sao_Paulo&quot;
});

document.getElementById( &quot;date-time-zone&quot; ).textContent =
  dateWithTimeZoneFormatter(new Date());
</code></pre>
<p>Another way to parse dates according to locale is to break it into its constituent parts. In this example we break it down into parts and, for illustrative purposes, it makes the month part bold.</p>
<pre><code class="language-javascript">var _dateToPartsFormatter =
  Globalize.dateToPartsFormatter({ datetime: &quot;medium&quot; });
var dateToPartsFormatter = function( value ) {
  return _dateToPartsFormatter( value, {
    datetime: &quot;medium&quot;
  }).map(function( part ) {
    switch(part.type) {
      case &quot;month&quot;: return &quot;&lt;strong&gt;&quot; + part.value + &quot;&lt;/strong&gt;&quot;;
      default: return part.value;
    }
  }).reduce(function( memo, value ) {
    return memo + value;
  });
  };
document.getElementById( &quot;date-to-parts&quot; ).innerHTML =
  dateToPartsFormatter( new Date() );
</code></pre>
<p>Next we test relative time formatting (<code>10 minutes ago</code> type) and unit type (<code>60 MPH</code>) type formatting.</p>
<pre><code class="language-javascript">var relativeTimeFormatter = Globalize.relativeTimeFormatter( &quot;second&quot; );
document.getElementById( &quot;relative-time&quot; ).textContent =
  relativeTimeFormatter( 0 );

var unitFormatter = Globalize.unitFormatter( &quot;mile/hour&quot;, { form: &quot;short&quot; } );
document.getElementById( &quot;unit&quot; ).textContent =
  unitFormatter( 60 );
</code></pre>
<aside class="message info">
  <p>The variables in the section below have been cut for formatting. Each <code>document.getElementById</code> and <code>Globalize.formatMessage</code> should be in the same line.</p>
</aside>
<p>These examples work with <code>formatMessage</code> for different strings. These will be used and localized in the HTML file described in the next section</p>
<pre><code class="language-javascript">// Messages.
document.getElementById( &quot;intro-1&quot; ).textContent =
 Globalize.formatMessage( &quot;intro-1&quot; );
document.getElementById( &quot;number-label&quot; ).textContent =
 Globalize.formatMessage( &quot;number-label&quot; );
document.getElementById( &quot;currency-label&quot; ).textContent =
 Globalize.formatMessage( &quot;currency-label&quot; );
document.getElementById( &quot;date-label&quot; ).textContent =
 Globalize.formatMessage( &quot;date-label&quot; );
document.getElementById( &quot;date-time-zone-label&quot; ).textContent =
 Globalize.formatMessage( &quot;date-time-zone-label&quot; );
document.getElementById( &quot;date-to-parts-label&quot; ).textContent =
 Globalize.formatMessage( &quot;date-to-parts-label&quot; );
document.getElementById( &quot;relative-time-label&quot; ).textContent =
 Globalize.formatMessage( &quot;relative-time-label&quot; );
document.getElementById( &quot;unit-label&quot; ).textContent =
 Globalize.formatMessage( &quot;unit-label&quot; );
document.getElementById( &quot;message-1&quot; ).textContent =
 Globalize.formatMessage( &quot;message-1&quot;, {
    currency: currencyFormatter( 69900 ),
    date: dateFormatter( new Date() ),
    number: numberFormatter( 12345.6789 ),
    relativeTime: relativeTimeFormatter( 0 ),
    unit: unitFormatter( 60 )
});

document.getElementById( &quot;message-2&quot; ).textContent =
  Globalize.formatMessage( &quot;message-2&quot;, {
      count: 3
});

// Display demo.
document.getElementById( &quot;requirements&quot; ).style.display = &quot;none&quot;;
document.getElementById( &quot;demo&quot; ).style.display = &quot;block&quot;;
</code></pre>
<p>The final bin in the script is a timing function that will update the valies in the timer once every 1000 milliseconds.</p>
<pre><code class="language-javascript">// Refresh elapsed time
setInterval(function() {
    var elapsedTime = +( ( startTime - new Date() ) / 1000 ).toFixed( 0 );
    document.getElementById( &quot;date&quot; ).textContent =
    dateFormatter( new Date() );
  document.getElementById( &quot;date-time-zone&quot; ).textContent =
    dateWithTimeZoneFormatter( new Date() );
  document.getElementById( &quot;date-to-parts&quot; ).innerHTML =
    dateToPartsFormatter( new Date() );
  document.getElementById( &quot;relative-time&quot; ).textContent =
    relativeTimeFormatter( elapsedTime );
  document.getElementById( &quot;message-1&quot; ).textContent =
    Globalize.formatMessage( &quot;message-1&quot;, {
      currency: currencyFormatter( 69900 ),
      date: dateFormatter( new Date() ),
      number: numberFormatter( 12345.6789 ),
      relativeTime: relativeTimeFormatter( elapsedTime ),
      unit: unitFormatter( 60 )
    });
}, 1000);
</code></pre>
<p>The final piece is the HTML documebnt that will hold all the localized messages generated during the build process and also links to the Webpack generated bundles as well.</p>
<pre><code class="language-html">&lt;!doctype html&gt;
&lt;html&gt;
&lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot;&gt;
  &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=edge&quot;&gt;
  &lt;title&gt;Globalize App example using Webpack&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;h1&gt;Globalize App example using Webpack&lt;/h1&gt;
  &lt;div id=&quot;requirements&quot;&gt;
    &lt;h2&gt;Requirements&lt;/h2&gt;
    &lt;ul&gt;
      &lt;li&gt;Read README.md for instructions on how to run the demo.
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/div&gt;
  &lt;div id=&quot;demo&quot; style=&quot;display: none&quot;&gt;
    &lt;p id=&quot;intro-1&quot;&gt;Use Globalize to internationalize your application.&lt;/p&gt;
  &lt;table border=&quot;1&quot; style=&quot;marginBottom: 1em;&quot;&gt;
    &lt;tbody&gt;
      &lt;tr&gt;
        &lt;td&gt;&lt;span id=&quot;number-label&quot;&gt;Standalone Number&lt;/span&gt;&lt;/td&gt;
        &lt;td&gt;&quot;&lt;span id=&quot;number&quot;&gt;&lt;/span&gt;&quot;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
        &lt;td&gt;&lt;span id=&quot;currency-label&quot;&gt;Standalone Currency&lt;/span&gt;&lt;/td&gt;
        &lt;td&gt;&quot;&lt;span id=&quot;currency&quot;&gt;&lt;/span&gt;&quot;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
        &lt;td&gt;&lt;span id=&quot;date-label&quot;&gt;Standalone Date&lt;/span&gt;&lt;/td&gt;
        &lt;td&gt;&quot;&lt;span id=&quot;date&quot;&gt;&lt;/span&gt;&quot;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
        &lt;td&gt;&lt;span id=&quot;date-time-zone-label&quot;&gt;Standalone Date
          (in a specific IANA time zone, e.g.,
          America/Los_Angeles)&lt;/span&gt;&lt;/td&gt;
        &lt;td&gt;&quot;&lt;span id=&quot;date-time-zone&quot;&gt;&lt;/span&gt;&quot;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
        &lt;td&gt;&lt;span id=&quot;date-to-parts-label&quot;&gt;Standalone Date (note the highlighted month, the markup was added using formatDateToParts)&lt;/span&gt;&lt;/td&gt;
        &lt;td&gt;&quot;&lt;span id=&quot;date-to-parts&quot;&gt;&lt;/span&gt;&quot;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
        &lt;td&gt;&lt;span id=&quot;relative-time-label&quot;&gt;Standalone Relative Time&lt;/span&gt;&lt;/td&gt;
        &lt;td&gt;&quot;&lt;span id=&quot;relative-time&quot;&gt;&lt;/span&gt;&quot;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
        &lt;td&gt;&lt;span id=&quot;unit-label&quot;&gt;Standalone Unit&lt;/span&gt;&lt;/td&gt;
        &lt;td&gt;&quot;&lt;span id=&quot;unit&quot;&gt;&lt;/span&gt;&quot;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;/tbody&gt;
    &lt;/table&gt;
    &lt;p id=&quot;message-1&quot;&gt;An example of a message using mixed number &quot;{number}&quot;, currency &quot;{currency}&quot;, date &quot;{date}&quot;, relative time &quot;{relativeTime}&quot;, and unit &quot;{unit}&quot;.
    &lt;/p&gt;
    &lt;p id=&quot;message-2&quot;&gt;
        An example of a message with pluralization support:
        {count, plural,
            one {You have one remaining task}
            other {You have # remaining tasks}
        }.
    &lt;/p&gt;
&lt;/div&gt;
{%
var hasShownLocaleHelp;
for ( var chunk in o.htmlWebpackPlugin.files.chunks ) {
  if ( /globalize-compiled-data-/.test( chunk ) &amp;&amp;
    chunk !== &quot;globalize-compiled-data-en&quot; ) {
    if ( !hasShownLocaleHelp ) {
      hasShownLocaleHelp = true;
%}
&lt;!--
Load support for the `en` (English) locale.
For displaying the application in a different locale, replace `en` with
whatever other supported locale you want, e.g., `pt` (Portuguese).
For supporting additional locales simultaneously and then having your
application to change it dynamically, load the multiple files here. Then,
use `Globalize.locale( &lt;locale&gt; )` in your application to dynamically set
it.
--&gt;
{%      } %}
&lt;!-- &lt;script src=&quot;{%=o.htmlWebpackPlugin.files.chunks[chunk].entry %}&quot;&gt;&lt;/script&gt; --&gt;
{%  } else { %}
&lt;script src=&quot;{%=o.htmlWebpackPlugin.files.chunks[chunk].entry %}&quot;&gt;&lt;/script&gt;
{%
    }
}
%}
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p><a id="markdown-caching-localization-assets-with-service-workers" name="caching-localization-assets-with-service-workers"></a></p>
<h2>Caching localization assets with service workers</h2>
<p>Since we’ve already used Webpack to build ouyr localization assets it’s easy to use <a href="https://developers.google.com/web/tools/workbox/">Workbox.js</a> to precache assets using a service worker.</p>
<pre><code class="language-javascript">const webpack = require( &quot;webpack&quot; );
const CommonsChunkPlugin = require( &quot;webpack/lib/optimize/CommonsChunkPlugin&quot; );
const HtmlWebpackPlugin = require( &quot;html-webpack-plugin&quot; );
const GlobalizePlugin = require( &quot;globalize-webpack-plugin&quot; );
const nopt = require( &quot;nopt&quot; );
const path = require('path');
const workboxPlugin = require('workbox-webpack-plugin');

const DIST_DIR = 'dist';

const options = nopt({
  production: Boolean
});

module.exports = {
  entry: options.production ?  {
    main: &quot;./app/index.js&quot;,
    vendor: [
      &quot;globalize&quot;,
      &quot;globalize/dist/globalize-runtime/number&quot;,
      &quot;globalize/dist/globalize-runtime/currency&quot;,
      &quot;globalize/dist/globalize-runtime/date&quot;,
      &quot;globalize/dist/globalize-runtime/message&quot;,
      &quot;globalize/dist/globalize-runtime/plural&quot;,
      &quot;globalize/dist/globalize-runtime/relative-time&quot;,
      &quot;globalize/dist/globalize-runtime/unit&quot;
    ]
  } : &quot;./app/index.js&quot;,
  debug: !options.production,
  output: {
    path: options.production ? &quot;./dist&quot; : &quot;./tmp&quot;,
    publicPath: options.production ? &quot;&quot; : &quot;http://localhost:8080/&quot;,
    filename: options.production ? &quot;app.[hash].js&quot; : &quot;app.js&quot;
  },
  resolve: {
    extensions: [ &quot;&quot;, &quot;.js&quot; ]
  },
  plugins: [
    new HtmlWebpackPlugin({
      production: options.production,
      template: &quot;./index-template.html&quot;
    }),
    new GlobalizePlugin({
      production: options.production,
      developmentLocale: &quot;en&quot;,
      supportedLocales: [ &quot;ar&quot;, &quot;de&quot;, &quot;en&quot;, &quot;es&quot;, &quot;pt&quot;, &quot;ru&quot;, &quot;zh&quot; ],
      messages: &quot;messages/[locale].json&quot;,
      output: &quot;i18n/[locale].[hash].js&quot;
    }),
    new webpack.optimize.DedupePlugin(),
    new CommonsChunkPlugin( &quot;vendor&quot;, &quot;vendor.[hash].js&quot; ),
    new webpack.optimize.UglifyJsPlugin({
      compress: {
        warnings: false
    }
    new workboxPlugin({
      globDirectory: dist,
      globPatterns: ['**/*.{html,css,js}'],
      swDest: path.join(dist, 'sw.js'),
      clientsClaim: true,
      skipWaiting: true,
    })
  ] : [] )
};
</code></pre>
<p>Because Workbox will cache all the assets for our application we want to make sure it’s the last plugin to run as part of the build process. Otherwise we may not get the assets we’ve processed in the way we want them.</p>
<p>Also, because we’re caching assets in the service worker cache we’ve elmiminated the concatenation step; this way if we make changes we only invalidate single files rather than entire bundles.</p>
<p>If you serve your content with HTTP2 it may work better if you serve smaller files rather than a few big ones.</p>
<p>Last detail. If you want finer control over what assets get precached, adjust thge values in the <code>globPatterns</code> attribute of the <code>workboxPlugin</code> to match what you need to cache.</p>
<p><a id="markdown-handling-content-for-multiple-languages" name="handling-content-for-multiple-languages"></a></p>
<h2>Handling content for multiple languages</h2>
<p>The Google Search Console Help article: <a href="https://support.google.com/webmasters/answer/182192?hl=en">Multi-regional and multilingual sites</a> defines multilingual and multi-regional websites as follows:</p>
<p>A <strong>multilingual website</strong> is any website that offers content in more than one language. Examples of multilingual websites might include a Canadian business with an English and a French version of its site, or a blog on Latin American soccer available in both Spanish and Portuguese.</p>
<p>A <strong>multi-regional</strong> website is one that explicitly targets users in different countries. Some sites are both multi-regional and multilingual (for example, a site might have different versions for the USA and for Canada, and both French and English versions of the Canadian content).</p>
<p>They go on to explain support strategies for both sites and how to best leverage your content and Google’s crawler to serve multiple languages.</p>
<p><a id="markdown-links-and-resources" name="links-and-resources"></a></p>
<h2>Links and Resources</h2>
<ul>
<li>Globalize
<ul>
<li><a href="https://github.com/globalizejs/globalize">Github Repo</a></li>
<li><a href="http://cldr.unicode.org/">http://cldr.unicode.org/</a></li>
<li><a href="http://site.icu-project.org/">http://site.icu-project.org/</a></li>
</ul>
</li>
<li>Messageformat
<ul>
<li><a href="https://messageformat.github.io/">Github Repo</a></li>
</ul>
</li>
<li><a href="https://developers.google.com/international/">Google Internationalization (i18n)</a></li>
<li>Noto Fonts
<ul>
<li><a href="https://www.google.com/get/noto/">Noto Fonts Download</a></li>
<li><a href="https://github.com/googlei18n/noto-fonts">Github Repository</a></li>
<li><a href="https://www.google.com/get/noto/help/guidelines/">Guidelines for Using Noto</a></li>
</ul>
</li>
<li><a href="https://blog.mozilla.org/l10n/2011/12/14/i18n-vs-l10n-whats-the-diff/">i18n vs l10n — what’s the diff?</a></li>
<li><a href="https://www.w3.org/International">W3C i18n Activity</a></li>
</ul>


<!-- <script src="../paged-media/highlight/highlight.pack.js"></script> -->
<script src="../paged-media/prism/prism.js"></script>
</body>
</html>