<html lang="en">

<head>
  <!-- <link rel="stylesheet" href="../paged-media/highlight/styles/solarized-light.css"> -->
  <link rel="stylesheet" href="../paged-media/prism/prism.css">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,minimum-scale=1,maximum-scale=1">
  <title></title>
</head>

<body data-type="book">

  <h1>Web Share APIs</h1>
<p>Sharing content from your web application takes two different APIs: Web Share make the content shareable and the Web Share Target API makes your app elegible to receive shared data.</p>
<h2>Getting Started</h2>
<p>We will first look at adding share capabilities to a web page.</p>
<p>The basic shape of the API looks like this:</p>
<pre><code class="language-js">navigator.share({ title: title, url: url })
  .then(function() { 
    console.log(&quot;Share success!&quot;);
  })
  .catch(function() {
    console.log(&quot;Share failure!&quot;);
  });
</code></pre>
<p>And here’s the code of my fist attempt to add it to a webpage. This will make the links with a <code>.share</code> class use the operating system’s share functionality.</p>
<pre><code class="language-js">  document.addEventListener('DOMContentLoaded', function () {
    var shareLinks = [].slice.call(document.querySelectorAll('.share'));
    shareLinks.forEach(function (link) {
      link.addEventListener('click', function (event) {
        if (typeof navigator.share !== 'undefined') {
          event.preventDefault();
          var pageTitle = document.querySelector('.post-title').textContent;
          var url = window.location.href;
          
          navigator.share({
              title: pageTitle,
              url: url
            })
            .then(function () {
              console.log(&quot;Share success!&quot;);
            })
            .catch(function () {
              console.log(&quot;Share failure!&quot;);
            });
        } else {
          console.log(&quot;Share not supported, revert to something else&quot;);
        }
      });
    });
  })

</code></pre>
<p>The script does the following:</p>
<ol>
<li>Wrap the code on a <code>DOMContentLoaded</code> event listener</li>
<li>Select all links with the class “share”</li>
<li>Add a <code>click</code> listener to each link</li>
<li>When a share link is clicked, check for the existence of <code>navigator.share</code></li>
<li>If it does exist, stop the link from doing anything</li>
<li>Get the URL from <code>window.location.href</code></li>
<li>Get the page title from the element with the class <code>post-title</code></li>
<li>Share the title and url</li>
</ol>
<p>This will work in all kinds of web content when using a supported browser in a supporting operating system.</p>
<div class="message info">
<p><strong>When implementing in a CMS</strong></p>
<p>When working with WordPress or any other CMS, there is an additional consideration</p>
<p>Instead of using <code>window.location.href</code> you should use the <a href="https://www.shopify.com/partners/blog/canonical-urls">canonical url</a> for the document, if one is defined. This will make for better SEO by sharing the authoritative URL for the page.</p>
</div>
<p></p>
<div class="message info">
  <p><strong>Note:</strong></p>
  <p>Web Share must be initiated by a user action. There is no way to activate it programmatically.</p>
</div>
<h2>Web Share Target API</h2>
<p>The other sided of sharing to and from your web application is the Web Share Target API, that allows your App to add itself as a handler for shared items.</p>
<p>When working with Chrome, an app must meet the following criteria to become a share target:</p>
<ul>
<li>It must meet Chrome’s <a href="https://developers.google.com/web/fundamentals/app-install-banners/#criteria">installability criteria</a></li>
<li>The user must add your app to their home screen</li>
</ul>
<p>If these conditions are met then you have to decide what do you want to users to share with your application.</p>
<p>This post will cover the simplest case where you just want to share basic information about the page you’re visiting. For other, more indepth cases, check out the <a href="https://web.dev/web-share-target/">Receiving shared data with the Web Share Target API</a>.</p>
<p>To share basic information with your app, add the following code to your web app manifest file:</p>
<pre><code class="language-json">&quot;share_target&quot;: {
  &quot;action&quot;: &quot;/share-target/&quot;,
  &quot;method&quot;: &quot;GET&quot;,
  &quot;params&quot;: {
    &quot;title&quot;: &quot;title&quot;,
    &quot;text&quot;: &quot;text&quot;,
    &quot;url&quot;: &quot;url&quot;
  }
}
</code></pre>
<p>Once your app has the data, it can process it and respond to it appropriately.</p>
<p>If the user selects your application, and your method is “GET” (the default), the browser opens a new window at the action URL. The browser then generates a query string using the URL-encoded values supplied in the manifest.</p>
<p>For example, if the sharing app provides title and text, the query string is <code>?title=hello&amp;text=world</code>. To process this, use a <code>DOMContentLoaded</code> event listener in your foreground page and parse the query string:</p>
<pre><code class="language-js">window.addEventListener('DOMContentLoaded', () =&gt; {
  const parsedUrl = new URL(window.location);
  console.log('Title shared: ' + parsedUrl.searchParams.get('title'));
  console.log('Text shared: ' + parsedUrl.searchParams.get('text'));
  console.log('URL shared: ' + parsedUrl.searchParams.get('url'));
});
</code></pre>
<p>What you do with the data you got from the shared item depends on your app. For example, you could use it to create a new document to edit or you could store it in an IndexedDB database.</p>
<p>To handle POST requests, check the Web.dev article referenced earlier.</p>
<h2>Links, Specs and Resources</h2>
<ul>
<li>Web Share API
<ul>
<li><a href="https://web.dev/web-share/">Integrate with the OS sharing UI with the Web Share API</a> — web.dev</li>
<li><a href="https://github.com/w3c/web-share/blob/master/docs/explainer.md">Web Share API Explainer</a></li>
<li><a href="https://philna.sh/blog/2017/03/14/the-web-share-api/">The Web Share API</a> — Phil Nash</li>
<li><a href="https://love2dev.com/blog/webshare-api/">How to Use the Web Share API to Trigger the Native Dialog to Share Content &amp; Pull Quotes</a> — Chris Love</li>
<li><a href="https://hospodarets.com/web-share-api">Web Share API brings the native sharing capabilities to the browser</a> — Serg Hospodarets</li>
</ul>
</li>
<li>Web Share Target API
<ul>
<li><a href="https://web.dev/web-share-target/">Receiving shared data with the Web Share Target API</a> — web.dev</li>
<li><a href="https://github.com/w3c/web-share-target/blob/master/docs/explainer.md">Web Share Target API Explainer</a></li>
</ul>
</li>
</ul>


<!-- <script src="../paged-media/highlight/highlight.pack.js"></script> -->
<script src="../paged-media/prism/prism.js"></script>
</body>
</html>