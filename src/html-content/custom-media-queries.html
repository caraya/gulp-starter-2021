<h1 id="new-and-upcoming-css%3A-%40custom-media">New and Upcoming CSS: @custom-media</h1>
<p>Of all the new features the one I’ve been researching is <code>@custom-media</code>.</p>
<p>Custom media queries allow you to create, in esence, create variables in CSS where we associate a name with a media query and can reuse it throughout the stylesheet.</p>
<p>This is useful as it gives authors a single place to make changes and prevents errors due to typos and not updating a media query exactly the same way everywhere it is used.</p>
<p>Naming things is also important. As Adam Argyle points out in <a href="https://web.dev/state-of-css-2022/#no-media-query-variables">No media query variables</a>:</p>
<blockquote>
<p>Naming things is very important: it can align purpose with the syntax, making things easier to share and easier to use in teams.</p>
</blockquote>
<p>In the following example, we define a narrow window media query using the <code>@custom-media</code> at-rule and a syntax using two dashes <code>--</code> as the starting chracters in the name. In this example, we also use media query ranges in the definition.</p>
<p>When we call the custom media query we only need to reference it by name, not the full media query. We can do this as many times as it is necessary.</p>
<pre class="language-css"><code class="language-css"><span class="token atrule"><span class="token rule">@custom-media</span> --narrow-window <span class="token punctuation">(</span> width &lt;= 30em<span class="token punctuation">)</span><span class="token punctuation">;</span></span>

<span class="token atrule"><span class="token rule">@media</span> <span class="token punctuation">(</span>--narrow-window<span class="token punctuation">)</span></span> <span class="token punctuation">{</span>
  <span class="token comment">/* narrow window styles */</span>
<span class="token punctuation">}</span>
</code></pre>
<p>In the same article, Adam provides examples of custom media queries from his <a href="https://open-props.style/">Open Props</a> project.</p>
<pre class="language-css"><code class="language-css"><span class="token comment">/* Viewport Variables */</span>
<span class="token atrule"><span class="token rule">@custom-media</span> --portrait      <span class="token punctuation">(</span><span class="token property">orientation</span><span class="token punctuation">:</span> portrait<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="token atrule"><span class="token rule">@custom-media</span> --landscape     <span class="token punctuation">(</span><span class="token property">orientation</span><span class="token punctuation">:</span> landscape<span class="token punctuation">)</span><span class="token punctuation">;</span></span>

<span class="token atrule"><span class="token rule">@custom-media</span> --md-only       <span class="token punctuation">(</span>480px &lt;= width &lt;= 768px<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="token atrule"><span class="token rule">@custom-media</span> --md-n-above    <span class="token punctuation">(</span>width >= 768px<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="token atrule"><span class="token rule">@custom-media</span> --md-n-below    <span class="token punctuation">(</span>width &lt;= 768px<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="token atrule"><span class="token rule">@custom-media</span> --md-phone      <span class="token punctuation">(</span>--md-only<span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token punctuation">(</span>--portrait<span class="token punctuation">)</span><span class="token punctuation">;</span></span>

<span class="token atrule"><span class="token rule">@custom-media</span> --xxl-only      <span class="token punctuation">(</span>1440px &lt;= width &lt;= 1920px<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="token atrule"><span class="token rule">@custom-media</span> --xxl-n-above   <span class="token punctuation">(</span>width >= 1920px<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="token atrule"><span class="token rule">@custom-media</span> --xxl-n-below   <span class="token punctuation">(</span>width &lt;= 1920px<span class="token punctuation">)</span><span class="token punctuation">;</span></span>

<span class="token comment">/* Capability Variables */</span>
<span class="token atrule"><span class="token rule">@custom-media</span> --touch    <span class="token punctuation">(</span><span class="token property">hover</span><span class="token punctuation">:</span> none<span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token punctuation">(</span><span class="token property">pointer</span><span class="token punctuation">:</span> coarse<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="token atrule"><span class="token rule">@custom-media</span> --stylus   <span class="token punctuation">(</span><span class="token property">hover</span><span class="token punctuation">:</span> none<span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token punctuation">(</span><span class="token property">pointer</span><span class="token punctuation">:</span> fine<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="token atrule"><span class="token rule">@custom-media</span> --pointer  <span class="token punctuation">(</span>hover<span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token punctuation">(</span><span class="token property">pointer</span><span class="token punctuation">:</span> coarse<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="token atrule"><span class="token rule">@custom-media</span> --mouse    <span class="token punctuation">(</span>hover<span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token punctuation">(</span><span class="token property">pointer</span><span class="token punctuation">:</span> fine<span class="token punctuation">)</span><span class="token punctuation">;</span></span>

<span class="token atrule"><span class="token rule">@custom-media</span> --HDcolor  <span class="token punctuation">(</span><span class="token property">dynamic-range</span><span class="token punctuation">:</span> high<span class="token punctuation">)</span><span class="token punctuation">;</span></span>

<span class="token comment">/* Preference Variables */</span>
<span class="token atrule"><span class="token rule">@custom-media</span> --highContrast  <span class="token punctuation">(</span><span class="token property">prefers-contrast</span><span class="token punctuation">:</span> high<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="token atrule"><span class="token rule">@custom-media</span> --lowContrast   <span class="token punctuation">(</span><span class="token property">prefers-contrast</span><span class="token punctuation">:</span> low<span class="token punctuation">)</span><span class="token punctuation">;</span></span>

<span class="token atrule"><span class="token rule">@custom-media</span> --opacityOK     <span class="token punctuation">(</span><span class="token property">prefers-reduced-transparency</span><span class="token punctuation">:</span> no-preference<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="token atrule"><span class="token rule">@custom-media</span> --opacityNotOK  <span class="token punctuation">(</span><span class="token property">prefers-reduced-transparency</span><span class="token punctuation">:</span> reduce<span class="token punctuation">)</span><span class="token punctuation">;</span></span>

<span class="token atrule"><span class="token rule">@custom-media</span> --useDataOK     <span class="token punctuation">(</span><span class="token property">prefers-reduced-data</span><span class="token punctuation">:</span> no-preference<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="token atrule"><span class="token rule">@custom-media</span> --useDataNotOK  <span class="token punctuation">(</span><span class="token property">prefers-reduced-data</span><span class="token punctuation">:</span> reduce<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
</code></pre>
<h2 id="links-and-resources">Links and Resources</h2>
<ul>
<li><a href="https://www.w3.org/TR/mediaqueries-5/#custom-mq">Custom Media Queries specification</a></li>
<li><a href="https://github.com/postcss/postcss-custom-media">Custom media queries PostCSS plugin</a></li>
<li><a href="https://bugs.chromium.org/p/chromium/issues/detail?id=1234172">Chromium Issue</a> — star the issue to improve odds of development</li>
</ul>
