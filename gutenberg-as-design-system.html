<html lang="en" dir="ltr" class="no-js lazy">

<head>
  <!--<link rel="stylesheet" href="ccs/github.css">-->
  <link rel="stylesheet" href="css/normalize.css">
  <link rel="stylesheet" href="css/main.css">
  <link rel="stylesheet" href="css/image-load.css">
  <link rel="stylesheet" href="css/video-load.css">
  <link rel="stylesheet" href="css/prism.css">
  <!-- <script async src="scripts/menu.js"></script> -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">


  <title></title>
</head>

<body>
<article class="container">
  <h1 id="gutenberg-as-a-design-system-(part-1)">Gutenberg as a design system (part 1)</h1>
<p>One of the things I’ve found the most intriguing about Gutenberg is the ability to create variations of a given element and build the basic components of a design systems.</p>
<p>From there we can also build what Brad Frost calls molecules, compositions of one or more elements that are used together.</p>
<p>This post will explore how to create variations of existing blocks and how to create composite blocks for our end users.</p>
<p>The examples below will only work when Gutenberg is in visual mode and will not work in classic editor or when Gutenber is in HTML mode.</p>
<h2 id="block-variations">Block Variations</h2>
<p>Variations are different styles or variations for a given component. The idea is that we don’t need to create custom blocks and then style them, we can use CSS to change the appearance of default blocks to suit our needs.</p>
<h3 id="client-side">Client Side</h3>
<p>The quickkest way to create block variations is to use client-side techniques and let the browser do all the work.</p>
<p>This takes the following steps:</p>
<ol>
<li>Define the block variations in the Javascript file we enqueued, <code>block-variations.js</code>
<ul>
<li>If necessary we remove existing custom styles from the elements we’re working on</li>
</ul>
</li>
<li>Enqueue the script in <code>index.php</code></li>
<li>Create the variations in <code>block-variations.js</code></li>
<li>Enqueue <code>block-variations.css</code>
<ul>
<li>Add styles for the variations in <code>block-variations.css</code></li>
</ul>
</li>
</ol>
<p>Enqueueing the script uses the <code>enqueue_block_editor_assets</code> action and a callback function as shown below.</p>
<p>Note that the enqueue script also list dependencies that must be loaded before the script we’re enqueueing. This makes sure we have no errors down the line.</p>
<pre class="language-php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">function</span> <span class="token function-definition function">rivendellweb_enqueue_variatons</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">wp_enqueue_script</span><span class="token punctuation">(</span>
    <span class="token string single-quoted-string">'myguten-script'</span><span class="token punctuation">,</span>
    <span class="token function">plugins_url</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'/lib/block-variations.js'</span><span class="token punctuation">,</span> <span class="token constant">__FILE__</span> <span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">array</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'wp-blocks'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'wp-dom-ready'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'wp-edit-post'</span> <span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">filemtime</span><span class="token punctuation">(</span> <span class="token function">plugin_dir_path</span><span class="token punctuation">(</span> <span class="token constant">__FILE__</span> <span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'/lib/block-variations.js'</span> <span class="token punctuation">)</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">add_action</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'enqueue_block_editor_assets'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'rivendellweb_enqueue_variatons'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code></pre>
<p>The variations script, <code>block-variations.js</code> has two parts. The first one removes any prior definitions of our blocks so that our definition will be the one that works.</p>
<pre class="language-js"><code class="language-js"><span class="token comment">// Unregister existing styles</span>
wp<span class="token punctuation">.</span><span class="token function">domReady</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  wp<span class="token punctuation">.</span>blocks<span class="token punctuation">.</span><span class="token function">unregisterBlockStyle</span><span class="token punctuation">(</span> <span class="token string">'core/quote'</span><span class="token punctuation">,</span> <span class="token string">'large'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
  wp<span class="token punctuation">.</span>blocks<span class="token punctuation">.</span><span class="token function">unregisterBlockStyle</span><span class="token punctuation">(</span> <span class="token string">'core/quote'</span><span class="token punctuation">,</span> <span class="token string">'fancy'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>The second part registers variations for different elements. In this example we’ve done one for paragraphs and three for blockquotes.</p>
<p><code>wp.blocks</code> is the ES5 version of this code. I chose it because using it I don’t have to use WebPack with it.</p>
<p>Each delcaration uses <code>registerBlockStyle</code> and has two parameters:</p>
<ol>
<li>The namespace and name of the block we’re customizing</li>
<li>An object with the properties for the variation. The attributes we’ve used are
<ul>
<li><strong>name</strong>: the short name for the variation</li>
<li><strong>label</strong>: the user visible name</li>
</ul>
</li>
</ol>
<pre class="language-js"><code class="language-js"><span class="token comment">// Paragraph variations</span>
wp<span class="token punctuation">.</span>blocks<span class="token punctuation">.</span><span class="token function">registerBlockStyle</span><span class="token punctuation">(</span> <span class="token string">'core/paragraph'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'lede-paragraph'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">label</span><span class="token operator">:</span> <span class="token string">'First Paragraph'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Blockquote variations</span>
wp<span class="token punctuation">.</span>blocks<span class="token punctuation">.</span><span class="token function">registerBlockStyle</span><span class="token punctuation">(</span> <span class="token string">'core/quote'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'fancy-quote'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">label</span><span class="token operator">:</span> <span class="token string">'Fancy Quote'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

wp<span class="token punctuation">.</span>blocks<span class="token punctuation">.</span><span class="token function">registerBlockStyle</span><span class="token punctuation">(</span> <span class="token string">'core/quote'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'top-bottom-quote'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">label</span><span class="token operator">:</span> <span class="token string">'Top and Bottom'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

wp<span class="token punctuation">.</span>blocks<span class="token punctuation">.</span><span class="token function">registerBlockStyle</span><span class="token punctuation">(</span> <span class="token string">'core/quote'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'red-quote'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">label</span><span class="token operator">:</span> <span class="token string">'Red Quote'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
<p>Next, add the styles for each of the variations, we wrap the styles on a <code>:root</code> rule to avoid some specificity problems. Even then there are conflicts with custom font sizes, so I’m either having to use !important (ugh), figure out a way to increase specificity or let the cascade do its thing.</p>
<pre class="language-css"><code class="language-css"><span class="token selector">:root</span> <span class="token punctuation">{</span>
  <span class="token selector">.is-style-lede-paragraph</span> <span class="token punctuation">{</span>
    <span class="token property">font-size</span><span class="token punctuation">:</span> 125%<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token selector">.is-style-fancy-quote</span> <span class="token punctuation">{</span>
    <span class="token property">border-left</span><span class="token punctuation">:</span> 4px solid red<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token selector">.is-style-top-bottom-quote</span> <span class="token punctuation">{</span>
    <span class="token property">border-top</span><span class="token punctuation">:</span> 4px solid black<span class="token punctuation">;</span>
    <span class="token property">border-bottom</span><span class="token punctuation">:</span> 4px solid black<span class="token punctuation">;</span>
    <span class="token property">border-left</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token selector">.is-style-red-quote</span> <span class="token punctuation">{</span>
    <span class="token property">color</span><span class="token punctuation">:</span> red<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>the final step is to enqueue the stylesheet to use in the front-end of the site. Because this is not for the editor, we need a different action to enqueue the styles.</p>
<pre class="language-php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">function</span> <span class="token function-definition function">rivendellweb_variation_styles</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">wp_enqueue_style</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'myguten-style'</span><span class="token punctuation">,</span> <span class="token function">plugins_url</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'style.css'</span><span class="token punctuation">,</span> <span class="token constant">__FILE__</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">add_action</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'enqueue_block_assets'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'rivendellweb_variation_styles'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code></pre>
<h3 id="server-side">Server Side</h3>
<p>We can also create all the variations on the server and add the styles from an external style sheet.</p>
<pre class="language-php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">wp_register_style</span><span class="token punctuation">(</span>
  <span class="token string single-quoted-string">'variations-style'</span><span class="token punctuation">,</span>
  <span class="token function">get_template_directory_uri</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'/variations/variation-styles.css'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code></pre>
<pre class="language-php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">register_block_style</span><span class="token punctuation">(</span>
    <span class="token function">register_block_style</span><span class="token punctuation">(</span>
      <span class="token string single-quoted-string">'core/paragraph'</span><span class="token punctuation">,</span>
      <span class="token keyword">array</span><span class="token punctuation">(</span>
        <span class="token string single-quoted-string">'name'</span> <span class="token operator">=></span> <span class="token string single-quoted-string">'lede-paragraph'</span><span class="token punctuation">,</span>
        <span class="token string single-quoted-string">'label'</span> <span class="token operator">=></span> <span class="token string single-quoted-string">'First Paragraph'</span><span class="token punctuation">,</span>
        <span class="token string single-quoted-string">'style_handle'</span> <span class="token operator">=></span> <span class="token string single-quoted-string">'variations-style'</span><span class="token punctuation">,</span>
      <span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">,</span>

    <span class="token comment">// Blockquote variations</span>
  <span class="token function">register_block_style</span><span class="token punctuation">(</span>
    <span class="token string single-quoted-string">'core/quote'</span><span class="token punctuation">,</span>
    <span class="token keyword">array</span><span class="token punctuation">(</span>
      <span class="token string single-quoted-string">'name'</span> <span class="token operator">=></span> <span class="token string single-quoted-string">'fancy-quote'</span><span class="token punctuation">,</span>
      <span class="token string single-quoted-string">'label'</span> <span class="token operator">=></span> <span class="token string single-quoted-string">'Fancy Quote'</span><span class="token punctuation">,</span>
      <span class="token string single-quoted-string">'style_handle'</span> <span class="token operator">=></span> <span class="token string single-quoted-string">'variations-style'</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token function">register_block_style</span><span class="token punctuation">(</span>
    <span class="token string single-quoted-string">'core/quote'</span><span class="token punctuation">,</span>
    <span class="token keyword">array</span><span class="token punctuation">(</span>
      <span class="token string single-quoted-string">'name'</span> <span class="token operator">=></span> <span class="token string single-quoted-string">'top-bottom-quote'</span><span class="token punctuation">,</span>
      <span class="token string single-quoted-string">'label'</span> <span class="token operator">=></span> <span class="token string single-quoted-string">'Top and Bottom'</span><span class="token punctuation">,</span>
      <span class="token string single-quoted-string">'style_handle'</span> <span class="token operator">=></span> <span class="token string single-quoted-string">'variations-style'</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token function">register_block_style</span><span class="token punctuation">(</span>
    <span class="token string single-quoted-string">'core/quote'</span><span class="token punctuation">,</span>
    <span class="token keyword">array</span><span class="token punctuation">(</span>
      <span class="token string single-quoted-string">'name'</span> <span class="token operator">=></span> <span class="token string single-quoted-string">'red-quote'</span><span class="token punctuation">,</span>
      <span class="token string single-quoted-string">'label'</span> <span class="token operator">=></span> <span class="token string single-quoted-string">'Red Quote'</span><span class="token punctuation">,</span>
      <span class="token string single-quoted-string">'style_handle'</span> <span class="token operator">=></span> <span class="token string single-quoted-string">'variations-style'</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code></pre>
<p>These types of customizations give us a full-powered design system on top of whatever custom blocks we create. In the next post we’ll discuss templating using blocks.</p>
<h1 id="gutenberg-as-a-design-system-(part-2)">Gutenberg as a design system (part 2)</h1>
<p>In <a href="https://publishing-project.rivendellweb.net/?p=790075&amp;preview=true">part 1</a> we discussed how to build variations for specific components.</p>
<p>We’ll now see how we can create templates ready for the user to fill and either use as-is or modify if when needed.</p>
<h2 id="block-templates">Block Templates</h2>
<p>The first type of template is at the block level. This allows the creation of complex blocks without having to do much on the PHP side.</p>
<p>We first import our tools like normal, the i18n utilities, registerBlockType and <a href="https://github.com/WordPress/gutenberg/tree/master/packages/block-editor/src/components/inner-blocks#README.md">InnerBlocks</a></p>
<pre class="language-js"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> __ <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@wordpress/i18n'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> registerBlockType <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@wordpress/blocks'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> InnerBlocks <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@wordpress/block-editor'</span><span class="token punctuation">;</span>
</code></pre>
<p>We then define our template in a constant. This is the structure of the block that we want to have.</p>
<p>We can use attributes of the blocks in the templace like the placeholder attribute that we use in the example to tell the user what we expect her to enter in each block.</p>
<pre class="language-js"><code class="language-js"><span class="token keyword">const</span> <span class="token constant">BLOCK_TEMPLATE</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">[</span> <span class="token string">'core/image'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span> <span class="token string">'core/heading'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">placeholder</span><span class="token operator">:</span> <span class="token string">'Book Title'</span> <span class="token punctuation">}</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span> <span class="token string">'core/heading'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">placeholder</span><span class="token operator">:</span> <span class="token string">'Book Author'</span> <span class="token punctuation">}</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span> <span class="token string">'core/paragraph'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">placeholder</span><span class="token operator">:</span> <span class="token string">'Summary'</span> <span class="token punctuation">}</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre>
<p>The block registration is no different than a custom block. The only difference is that our <code>InnerBlocks</code> declaration uses a template attribute with our <code>BLOCK_TEMPLATE</code> definition as the parameter.</p>
<p>In this example we’ve chosen to lock the template so the user cannot move the inner blocks nor they can add any new block to the template.</p>
<p>The save methods remains the same.</p>
<pre class="language-js"><code class="language-js"><span class="token function">registerBlockType</span><span class="token punctuation">(</span> <span class="token string">'rivendellweb-blocks/example-06'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token function">__</span><span class="token punctuation">(</span><span class="token string">'Example 06'</span><span class="token punctuation">,</span> <span class="token string">'rivendellweb-blocks'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token literal-property property">category</span><span class="token operator">:</span> <span class="token string">'rivendellweb-blocks'</span><span class="token punctuation">,</span>
	<span class="token literal-property property">icon</span><span class="token operator">:</span> <span class="token string">'translation'</span><span class="token punctuation">,</span>

  <span class="token function-variable function">edit</span><span class="token operator">:</span> <span class="token punctuation">(</span> <span class="token parameter"><span class="token punctuation">{</span> className <span class="token punctuation">}</span></span> <span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token punctuation">{</span> className <span class="token punctuation">}</span><span class="token operator">></span>
        <span class="token operator">&lt;</span>InnerBlocks
        template<span class="token operator">=</span><span class="token punctuation">{</span> <span class="token constant">BLOCK_TEMPLATE</span> <span class="token punctuation">}</span>
        templateLock<span class="token operator">=</span><span class="token string">"all"</span> <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token function-variable function">save</span><span class="token operator">:</span> <span class="token punctuation">(</span> <span class="token parameter"><span class="token punctuation">{</span> className <span class="token punctuation">}</span></span> <span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token punctuation">{</span> className <span class="token punctuation">}</span><span class="token operator">></span>
        <span class="token operator">&lt;</span>InnerBlocks<span class="token punctuation">.</span>Content <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<div class="message warning">
  <h2>Thing To Watch Out For</h2>
  <p>Out of the box, the styles in the editor will not necessarily match the styles when published. You need to be careful and make sure that the editor styles match the front-end styles or are close enough that you won't be surprised by what the published content looks like.</p>
</div>
<div class="message warning">
  <h2>Thing To Watch Out For</h2>
  <p>Be careful when following Gutenberg examples out in the wild as they are very inconsistent.  Some will use ES5 rather than ES6+ and some will juse JSX while others will use React's create eleent syntax.  I'm not saying either version is bad, I'm just warning readers that this the case so they are prepared, particularly if, like me, they are not fluent in React and how it works.
<h2 id="looking-forward%3A-block-patterns-and-block-pattern-libraries">Looking forward: Block Patterns and Block Pattern Libraries</h2>
<p>Block Patterns API is an API currently under development that would make custom blocks and variations available to users in similar ways to what other sites like Wix, SquareSpace, and Weebly and even page builders in WordPress like <a href="https://elementor.com/">Elementor</a> already do.</p>
<figure>
  <img src="https://cdn.richtabor.com/wp-content/uploads/2020/03/ss.jpg" alt="sections in the SquareSpace editor">
  <figcaption>Sections as they apper in SquareSpace (from <a href="https://richtabor.com/block-patterns/">Gutenberg Block Patterns: The Future of Page Building in WordPress</a>)</figcaption>
</figure>
<p>Variations already give us a way to create custom styles for our existing blocks so the next logical step, to me, is to package the variations and present them to the user in a way that is more coherent to them.</p>
<p>Figure 2 shows a mockup of how the patterns may be surfaced to the user.</p>
<figure>
  <img src="https://cdn.richtabor.com/wp-content/uploads/2020/03/patterns.jpg" alt="Mockup of patterns within the Gutenberg block library">
  <figcaption>Mockup of patterns within the Gutenberg block library (from <a href="https://richtabor.com/block-patterns/">Gutenberg Block Patterns: The Future of Page Building in WordPress</a>)</figcaption>
</figure>
<p>Current work in patterns uses a very low-level Gutenberg syntax. For example, a hero section becomes this combination of WordPress-specific commands and HTML styled with WordPress-provided classes:</p>
<pre class="language-html"><code class="language-html"><span class="token comment">&lt;!-- wp:group {"backgroundColor":"very-light-gray","align":"full"} --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>wp-block-group alignfull has-very-light-gray-background-color has-background<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>wp-block-group__inner-container<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token comment">&lt;!-- wp:spacer --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">height</span><span class="token punctuation">:</span>100px</span><span class="token punctuation">"</span></span></span> <span class="token attr-name">aria-hidden</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>wp-block-spacer<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token comment">&lt;!-- /wp:spacer --></span>

<span class="token comment">&lt;!-- wp:columns {"align":"wide"} --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>wp-block-columns alignwide<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token comment">&lt;!-- wp:column --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>wp-block-column<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token comment">&lt;!-- wp:heading {"textColor":"very-dark-gray"} --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>has-very-dark-gray-color has-text-color<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Lorem ipsum sit amet, consectetur adipiscing elit<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span>
<span class="token comment">&lt;!-- /wp:heading --></span>

<span class="token comment">&lt;!-- wp:paragraph {"textColor":"very-dark-gray","fontSize":"medium"} --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>has-text-color has-medium-font-size has-very-dark-gray-color<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>
<span class="token comment">&lt;!-- /wp:paragraph --></span>

<span class="token comment">&lt;!-- wp:buttons --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>wp-block-buttons<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token comment">&lt;!-- wp:button {"backgroundColor":"strong-blue","borderRadius":2} --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>wp-block-button<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>wp-block-button__link has-background has-strong-blue-background-color<span class="token punctuation">"</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">border-radius</span><span class="token punctuation">:</span>2px</span><span class="token punctuation">"</span></span></span><span class="token punctuation">></span></span>Call to action<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token comment">&lt;!-- /wp:button --></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token comment">&lt;!-- /wp:buttons --></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token comment">&lt;!-- /wp:column --></span>

<span class="token comment">&lt;!-- wp:column --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>wp-block-column<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token comment">&lt;!-- wp:image {"id":306,"width":512,"height":384,"sizeSlug":"large","className":"is-style-default"} --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>figure</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>wp-block-image size-large is-resized is-style-default<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://nrqsnchztest.blog/wp-content/uploads/2020/02/swinging-1024x768.png<span class="token punctuation">"</span></span> <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>wp-image-306<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>512<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>384<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>figure</span><span class="token punctuation">></span></span>
<span class="token comment">&lt;!-- /wp:image --></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token comment">&lt;!-- /wp:column --></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token comment">&lt;!-- /wp:columns --></span>

<span class="token comment">&lt;!-- wp:spacer --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">height</span><span class="token punctuation">:</span>100px</span><span class="token punctuation">"</span></span></span> <span class="token attr-name">aria-hidden</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>wp-block-spacer<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token comment">&lt;!-- /wp:spacer --></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token comment">&lt;!-- /wp:group --></span>
</code></pre>
<p>and looks like this:</p>
<figure>
  <img src="https://publishing-project.rivendellweb.net/wp-content/uploads/2020/04/hero01-gutenberg-pattern.png" alt="Hero Pattern for use with Gutenberg">
  <figcaption>Hero Pattern for use with Gutenberg</figcaption>
</figure>
<p>Right now, designing patterns is not as easy or intuitive as it can be. I expect it to change when the code for patterns lands in the plugin and then in WordPress core. I also expect to be able to author the content visually using the built-in editor.</p>
<h2 id="links-and-resources">Links and Resources</h2>
<ul>
<li><a href="https://github.com/WordPress/gutenberg/issues/20345">Block patterns: create patterns to start populating the library #20345</a></li>
<li><a href="https://github.com/WordPress/gutenberg/issues/16283">Variations (formerly patterns) API for blocks #16283</a></li>
<li><a href="https://github.com/WordPress/gutenberg/issues/17335">Block Patterns: Add ability for predefined block layouts to be added to a document #17335</a></li>
<li><a href="https://github.com/WordPress/gutenberg/pull/20145">Docs: Add docs for variations in the block registration section #20145</a></li>
</ul>
<h2 id="gutenberg-as-design-systems-(part-3)">Gutenberg as design systems (part 3)</h2>
<p>Blocks are awesome and provide a graphical way to create content but sharing them is not as intuitive as I would like to be, at least not yet.</p>
<p>This post will discuss how to use plugins to share both custom blocks, variations and combined blocks and variations.</p>
<h2 id="custom-blocks">Custom Blocks</h2>
<p>In the plugin’s <code>index.php</code> we create a block category where we can place all our blocks.</p>
<p>The comment at the top of the page contains the information that will appear in the plugins page.</p>
<p>The first functions <code>rivendellweb_blocks_block_category</code> defines a callback function that creates a category for the blocks we create. We then use the <code>block_categories</code> filter with the <code>rivendellweb_blocks_block_category</code> callback function.</p>
<p>Next we include the blocks that we have creaated using <code>require example-0x/index.php</code> where the x represents a different directory containing a custom block.</p>
<pre class="language-php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token comment">/**
 * Plugin Name: Rivendellweb Blocks
 * Plugin URI: https://github.com/WordPress/rivendellweb-blocks
 * Description: Rivendellweb blocks collection.
 * Version: 0.0.1
 * Author: Carlos Araya
 *
 * @package rivendellweb-blocks
 */</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">!</span> <span class="token function">defined</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'ABSPATH'</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">exit</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-definition function">rivendellweb_blocks_block_category</span><span class="token punctuation">(</span> <span class="token variable">$categories</span><span class="token punctuation">,</span> <span class="token variable">$post</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token variable">$post</span><span class="token operator">-></span><span class="token property">post_type</span> <span class="token operator">!==</span> <span class="token string single-quoted-string">'post'</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token variable">$categories</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token function">array_merge</span><span class="token punctuation">(</span>
    <span class="token variable">$categories</span><span class="token punctuation">,</span>
    <span class="token keyword">array</span><span class="token punctuation">(</span>
      <span class="token keyword">array</span><span class="token punctuation">(</span>
        <span class="token string single-quoted-string">'slug'</span> <span class="token operator">=></span> <span class="token string single-quoted-string">'rivendellweb-blocks'</span><span class="token punctuation">,</span>
        <span class="token string single-quoted-string">'title'</span> <span class="token operator">=></span> <span class="token function">__</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'Rivendellweb Blocks'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'rivendellweb-blocks'</span> <span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token string single-quoted-string">'icon'</span>  <span class="token operator">=></span> <span class="token string single-quoted-string">'wordpress'</span><span class="token punctuation">,</span>
      <span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">add_filter</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'block_categories'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'rivendellweb_blocks_block_category'</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token keyword">include</span> <span class="token string single-quoted-string">'example-01/index.php'</span><span class="token punctuation">;</span>
<span class="token keyword">include</span> <span class="token string single-quoted-string">'example-02/index.php'</span><span class="token punctuation">;</span>
<span class="token keyword">include</span> <span class="token string single-quoted-string">'example-03/index.php'</span><span class="token punctuation">;</span>
<span class="token keyword">include</span> <span class="token string single-quoted-string">'example-04/index.php'</span><span class="token punctuation">;</span>
<span class="token keyword">include</span> <span class="token string single-quoted-string">'example-05/index.php'</span><span class="token punctuation">;</span>
<span class="token keyword">include</span> <span class="token string single-quoted-string">'example-06/index.php'</span><span class="token punctuation">;</span>
<span class="token keyword">include</span> <span class="token string single-quoted-string">'example-07/index.php'</span><span class="token punctuation">;</span>
</span></code></pre>
<p>If the blocks are valid and the individual build processes succeeded, then the plugin will add seven blocks to Gutenberg running on the server.</p>
<p>The full example is on github at <a href="https://github.com/caraya/rivendellweb-blocks">rivendellweb-blocks</a> and have been tested with Gutenberg 7.9.1 and with Github Gutenberg.</p>
<h2 id="block-variations-1">Block Variations</h2>
<p>As discussed earlier, variations allow you to change the look of a block without having to code a brand new version.  The plugin that holds these variations has three files:</p>
<ul>
<li>A PHP file that makes the package into a plugin and links to scripts and styles</li>
<li>A Javascript files with the variation definitions</li>
<li>A CSS files containing the variations’ styles</li>
</ul>
<p>The plugin’s <code>index.php</code> has the plugin boilerplate comment and two action + callback instances: one to enqueue the scrip and one to enqueue the stylesheet.</p>
<pre class="language-php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token comment">/**
 * Plugin Name: Rivendellweb variations
 * Plugin URI: https://github.com/WordPress/rivendellweb-variations
 * Description: Rivendellweb blocks variations.
 * Version: 0.0.1
 * Author: Carlos Araya
 *
 * @package rivendellweb-blocks
 */</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">!</span> <span class="token function">defined</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'ABSPATH'</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">exit</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-definition function">rivendellweb_enqueue_variations</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">wp_enqueue_script</span><span class="token punctuation">(</span>
        <span class="token string single-quoted-string">'rivendellweb-script'</span><span class="token punctuation">,</span>
        <span class="token function">plugins_url</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'./src/block-variations.js'</span><span class="token punctuation">,</span> <span class="token constant">__FILE__</span> <span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">array</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'wp-blocks'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'wp-dom-ready'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'wp-edit-post'</span> <span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token function">filemtime</span><span class="token punctuation">(</span> <span class="token function">plugin_dir_path</span><span class="token punctuation">(</span> <span class="token constant">__FILE__</span> <span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'build/block-variations.js'</span> <span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">add_action</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'enqueue_block_editor_assets'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'rivendellweb_enqueue_variations'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function-definition function">rivendellweb_variation_styles</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">wp_enqueue_style</span><span class="token punctuation">(</span>
		<span class="token string single-quoted-string">'rivendellweb_variations_css'</span><span class="token punctuation">,</span>
		<span class="token function">plugins_url</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'./src/block-variations.css'</span><span class="token punctuation">,</span> <span class="token constant">__FILE__</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">add_action</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'enqueue_block_assets'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'rivendellweb_variation_styles'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code></pre>
<p>The full example is on github at <a href="https://github.com/caraya/rivendellweb-variations">rivendellweb-variations</a> and have been tested with Gutenberg 7.9.1 and with Github Gutenberg.</p>
<h2 id="both-together">Both Together</h2>
<p>Whether to combine the two plugins discussed in this post into a single plugin is the reader’s choice. I chose not to because I believe that each plugin should do one thing only and do it well.</p>

</article>
<!--
</div> -->
<script src="scripts/lazy-load.js"></script>
<script src="scripts/vendor/clipboard.min.js"></script>
<script src="scripts/vendor/prism.js"></script>
<script src="scripts/vendor/fontfaceobserver.js"></script>
<script src="scripts/load-fonts.js"></script>
<script src="scripts/lazy-load-video.js"></script>
</body>
</html>